<!doctype html><html lang=zh-CN><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="noodp"><title>网络协议 - 灰灰爱吃小云朵</title><meta name=Description content="欢迎来到灰灰爱吃小云朵的博客!"><meta property="og:title" content="网络协议">
<meta property="og:description" content><meta property="og:type" content="article"><meta property="og:url" content="https://200928.github.io/posts/%E7%BD%91%E7%BB%9C%E5%8D%8F%E8%AE%AE/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-02-18T09:29:57+00:00"><meta property="article:modified_time" content="2023-03-18T09:29:57+00:00"><meta property="og:site_name" content="灰灰爱吃小云朵"><meta name=twitter:card content="summary"><meta name=twitter:title content="网络协议"><meta name=twitter:description content><meta name=application-name content="My cool site"><meta name=apple-mobile-web-app-title content="My cool site"><meta name=theme-color content="#ffffff"><meta name=msapplication-TileColor content="#da532c"><link rel="shortcut icon" type=image/x-icon href=/favicon.ico><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><link rel=manifest href=/site.webmanifest><link rel=canonical href=https://200928.github.io/posts/%E7%BD%91%E7%BB%9C%E5%8D%8F%E8%AE%AE/><link rel=prev href=https://200928.github.io/posts/archlinux%E5%A4%96%E6%8E%A5%E6%98%BE%E7%A4%BA%E5%99%A8/><link rel=next href=https://200928.github.io/posts/%E5%BC%95%E7%94%A8%E4%BC%A0%E9%80%92/><link rel=stylesheet href=/css/style.min.css><link rel=preload href=https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css as=style onload='this.onload=null,this.rel="stylesheet"'><noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css></noscript><link rel=preload href=https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css as=style onload='this.onload=null,this.rel="stylesheet"'><noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css></noscript><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"网络协议","inLanguage":"zh-CN","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/200928.github.io\/posts\/%E7%BD%91%E7%BB%9C%E5%8D%8F%E8%AE%AE\/"},"genre":"posts","keywords":"HTTP, TCP, IP","wordcount":8111,"url":"https:\/\/200928.github.io\/posts\/%E7%BD%91%E7%BB%9C%E5%8D%8F%E8%AE%AE\/","datePublished":"2023-02-18T09:29:57+00:00","dateModified":"2023-03-18T09:29:57+00:00","publisher":{"@type":"Organization","name":""},"author":{"@type":"Person","name":"xiaozao"},"description":""}</script></head><body data-header-desktop=fixed data-header-mobile=auto><script type=text/javascript>(window.localStorage&&localStorage.getItem("theme")?localStorage.getItem("theme")==="dark":"auto"==="auto"?window.matchMedia("(prefers-color-scheme: dark)").matches:"auto"==="dark")&&document.body.setAttribute("theme","dark")</script><div id=mask></div><div class=wrapper><header class=desktop id=header-desktop><div class=header-wrapper><div class=header-title><a href=/ title=灰灰爱吃小云朵>灰灰爱吃小云朵</a></div><div class=menu><div class=menu-inner><a class=menu-item href=/posts/><i class='fa-solid fa-file-pen'></i> 文章 </a><a class=menu-item href=/tags/><i class='fa-solid fa-tags'></i> 标签 </a><a class=menu-item href=/categories/><i class='fa-solid fa-layer-group'></i> 分类 </a><a class=menu-item href=/about/>关于 </a><a class=menu-item href=/catch-the-cat/><i class='fas fa-fw fa-fan fa-spin'></i> 猫咪 </a><span class="menu-item delimiter"></span><span class="menu-item search" id=search-desktop>
<input type=text placeholder="Search titles or contents..." id=search-input-desktop>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-desktop title=Search><i class="fas fa-search fa-fw" aria-hidden=true></i>
</a><a href=javascript:void(0); class="search-button search-clear" id=search-clear-desktop title=Clear><i class="fas fa-times-circle fa-fw" aria-hidden=true></i>
</a><span class="search-button search-loading" id=search-loading-desktop><i class="fas fa-spinner fa-fw fa-spin" aria-hidden=true></i>
</span></span><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme"><i class="fas fa-adjust fa-fw" aria-hidden=true></i></a></div></div></div></header><header class=mobile id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/ title=灰灰爱吃小云朵>灰灰爱吃小云朵</a></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><div class=menu id=menu-mobile><div class=search-wrapper><div class="search mobile" id=search-mobile><input type=text placeholder="Search titles or contents..." id=search-input-mobile>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-mobile title=Search><i class="fas fa-search fa-fw" aria-hidden=true></i>
</a><a href=javascript:void(0); class="search-button search-clear" id=search-clear-mobile title=Clear><i class="fas fa-times-circle fa-fw" aria-hidden=true></i>
</a><span class="search-button search-loading" id=search-loading-mobile><i class="fas fa-spinner fa-fw fa-spin" aria-hidden=true></i></span></div><a href=javascript:void(0); class=search-cancel id=search-cancel-mobile>Cancel</a></div><a class=menu-item href=/posts/ title><i class='fa-solid fa-file-pen'></i>文章</a><a class=menu-item href=/tags/ title><i class='fa-solid fa-tags'></i>标签</a><a class=menu-item href=/categories/ title><i class='fa-solid fa-layer-group'></i>分类</a><a class=menu-item href=/about/ title>关于</a><a class=menu-item href=/catch-the-cat/ title><i class='fas fa-fw fa-fan fa-spin'></i>猫咪</a><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme">
<i class="fas fa-adjust fa-fw" aria-hidden=true></i></a></div></div></header><div class="search-dropdown desktop"><div id=search-dropdown-desktop></div></div><div class="search-dropdown mobile"><div id=search-dropdown-mobile></div></div><main class=main><div class=container><div class=toc id=toc-auto><h2 class=toc-title>Contents</h2><div class=toc-content id=toc-content-auto></div></div><article class="page single"><h1 class="single-title animate__animated animate__flipInX">网络协议</h1><div class=post-meta><div class=post-meta-line><span class=post-author><a href=/ title=Author rel=author class=author><i class="fas fa-user-circle fa-fw" aria-hidden=true></i>xiaozao</a></span>&nbsp;<span class=post-category>included in <a href=/categories/%E5%AD%A6%E4%B9%A0/><i class="far fa-folder fa-fw" aria-hidden=true></i>学习</a></span></div><div class=post-meta-line><i class="far fa-calendar-alt fa-fw" aria-hidden=true></i>&nbsp;<time datetime=2023-02-18>2023-02-18</time>&nbsp;<i class="fas fa-pencil-alt fa-fw" aria-hidden=true></i>&nbsp;8111 words&nbsp;
<i class="far fa-clock fa-fw" aria-hidden=true></i>&nbsp;17 minutes&nbsp;
<span id=busuanzi_container_value_page_pv><i class="far fa-eye fa-fw"></i>
<span id=busuanzi_value_page_pv></span>&nbsp;views</span></div></div><div class="details toc" id=toc-static data-kept><div class="details-summary toc-title"><span>Contents</span>
<span><i class="details-icon fas fa-angle-right" aria-hidden=true></i></span></div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents><ul><li><a href=#局域网>局域网</a></li><li><a href=#公网vs私网>公网Vs私网</a><ul><li><a href=#公网>公网</a></li><li><a href=#私网>私网</a></li><li><a href=#nat>NAT</a></li></ul></li><li><a href=#网络分层>网络分层</a><ul><li><a href=#物理层>物理层</a></li><li><a href=#数据链路层>数据链路层</a><ul><li><a href=#链路>链路</a></li><li><a href=#网卡>网卡</a></li><li><a href=#csmacd协议>CSMA/CD协议</a></li><li><a href=#ethernet-v2帧>Ethernet V2帧</a></li><li><a href=#ppp协议>PPP协议</a></li></ul></li><li><a href=#网络层>网络层</a><ul><li><a href=#书中摘要>书中摘要</a></li></ul></li><li><a href=#传输层>传输层</a><ul><li><a href=#udp>UDP</a></li></ul></li></ul></li><li><a href=#网络安全>网络安全</a><ul><li><a href=#http协议安全问题>HTTP协议安全问题</a><ul><li><a href=#不可逆加密>不可逆加密</a><ul><li><a href=#单向散列函数>单向散列函数</a></li></ul></li><li><a href=#可逆加密>可逆加密</a><ul><li><a href=#对称加密symmetric-cryptography>对称加密(Symmetric Cryptography)</a><ul><li><a href=#des>DES</a></li><li><a href=#3des>3DES</a></li><li><a href=#aes>AES</a></li><li><a href=#密钥配送问题>密钥配送问题</a></li></ul></li><li><a href=#非对称加密asymmetric-cryptography>非对称加密(Asymmetric Cryptography)</a><ul><li><a href=#公钥私钥>公钥、私钥</a></li><li><a href=#公钥的合法性>公钥的合法性</a></li><li><a href=#通信举例>通信举例</a></li><li><a href=#rsa>RSA</a></li></ul></li><li><a href=#对称加密与非对称加密>对称加密与非对称加密</a></li><li><a href=#混合密码>混合密码</a></li></ul></li><li><a href=#数字签名>数字签名</a></li><li><a href=#证书>证书</a><ul><li><a href=#证书的使用过程>证书的使用过程</a></li><li><a href=#证书的注册和下载>证书的注册和下载</a></li></ul></li></ul></li><li><a href=#https>HTTPS</a><ul><li><a href=#ssltls>SSL/TLS</a></li><li><a href=#openssl>OpenSSL</a></li><li><a href=#成本>成本</a></li><li><a href=#heading></a></li></ul></li></ul></li><li><a href=#引用>引用</a></li></ul></nav></div></div><div class=content id=content><ul><li><a href=#%e5%b1%80%e5%9f%9f%e7%bd%91 rel>局域网</a></li><li><a href=#%e5%85%ac%e7%bd%91vs%e7%a7%81%e7%bd%91 rel>公网Vs私网</a><ul><li><a href=#%e5%85%ac%e7%bd%91 rel>公网</a></li><li><a href=#%e7%a7%81%e7%bd%91 rel>私网</a></li><li><a href=#nat rel>NAT</a></li></ul></li><li><a href=#%e7%bd%91%e7%bb%9c%e5%88%86%e5%b1%82 rel>网络分层</a><ul><li><a href=#%e7%89%a9%e7%90%86%e5%b1%82 rel>物理层</a></li><li><a href=#%e6%95%b0%e6%8d%ae%e9%93%be%e8%b7%af%e5%b1%82 rel>数据链路层</a><ul><li><a href=#%e9%93%be%e8%b7%af rel>链路</a></li><li><a href=#%e7%bd%91%e5%8d%a1 rel>网卡</a></li><li><a href=#csmacd%e5%8d%8f%e8%ae%ae rel>CSMA/CD协议</a></li><li><a href=#ethernet-v2%e5%b8%a7 rel>Ethernet V2帧</a></li><li><a href=#ppp%e5%8d%8f%e8%ae%ae rel>PPP协议</a></li></ul></li><li><a href=#%e7%bd%91%e7%bb%9c%e5%b1%82 rel>网络层</a><ul><li><a href=#%e4%b9%a6%e4%b8%ad%e6%91%98%e8%a6%81 rel>书中摘要</a></li></ul></li><li><a href=#%e4%bc%a0%e8%be%93%e5%b1%82 rel>传输层</a><ul><li><a href=#udp rel>UDP</a></li></ul></li></ul></li><li><a href=#%e7%bd%91%e7%bb%9c%e5%ae%89%e5%85%a8 rel>网络安全</a><ul><li><a href=#http%e5%8d%8f%e8%ae%ae%e5%ae%89%e5%85%a8%e9%97%ae%e9%a2%98 rel>HTTP协议安全问题</a><ul><li><a href=#%e4%b8%8d%e5%8f%af%e9%80%86%e5%8a%a0%e5%af%86 rel>不可逆加密</a><ul><li><a href=#%e5%8d%95%e5%90%91%e6%95%a3%e5%88%97%e5%87%bd%e6%95%b0 rel>单向散列函数</a></li></ul></li><li><a href=#%e5%8f%af%e9%80%86%e5%8a%a0%e5%af%86 rel>可逆加密</a><ul><li><a href=#%e5%af%b9%e7%a7%b0%e5%8a%a0%e5%af%86symmetric-cryptography rel>对称加密(Symmetric Cryptography)</a><ul><li><a href=#des rel>DES</a></li><li><a href=#3des rel>3DES</a></li><li><a href=#aes rel>AES</a></li><li><a href=#%e5%af%86%e9%92%a5%e9%85%8d%e9%80%81%e9%97%ae%e9%a2%98 rel>密钥配送问题</a></li></ul></li><li><a href=#%e9%9d%9e%e5%af%b9%e7%a7%b0%e5%8a%a0%e5%af%86asymmetric-cryptography rel>非对称加密(Asymmetric Cryptography)</a><ul><li><a href=#%e5%85%ac%e9%92%a5%e7%a7%81%e9%92%a5 rel>公钥、私钥</a></li><li><a href=#%e5%85%ac%e9%92%a5%e7%9a%84%e5%90%88%e6%b3%95%e6%80%a7 rel>公钥的合法性</a></li><li><a href=#%e9%80%9a%e4%bf%a1%e4%b8%be%e4%be%8b rel>通信举例</a></li><li><a href=#rsa rel>RSA</a></li></ul></li><li><a href=#%e5%af%b9%e7%a7%b0%e5%8a%a0%e5%af%86%e4%b8%8e%e9%9d%9e%e5%af%b9%e7%a7%b0%e5%8a%a0%e5%af%86 rel>对称加密与非对称加密</a></li><li><a href=#%e6%b7%b7%e5%90%88%e5%af%86%e7%a0%81 rel>混合密码</a></li></ul></li><li><a href=#%e6%95%b0%e5%ad%97%e7%ad%be%e5%90%8d rel>数字签名</a></li><li><a href=#%e8%af%81%e4%b9%a6 rel>证书</a><ul><li><a href=#%e8%af%81%e4%b9%a6%e7%9a%84%e4%bd%bf%e7%94%a8%e8%bf%87%e7%a8%8b rel>证书的使用过程</a></li><li><a href=#%e8%af%81%e4%b9%a6%e7%9a%84%e6%b3%a8%e5%86%8c%e5%92%8c%e4%b8%8b%e8%bd%bd rel>证书的注册和下载</a></li></ul></li></ul></li><li><a href=#https rel>HTTPS</a><ul><li><a href=#ssltls rel>SSL/TLS</a></li><li><a href=#openssl rel>OpenSSL</a></li><li><a href=#%e6%88%90%e6%9c%ac rel>成本</a></li></ul></li></ul></li><li><a href=#%e5%bc%95%e7%94%a8 rel>引用</a></li></ul><h1 id=局域网>局域网</h1><ol><li><p>电话线入户（ADSL）</p></li><li><p>网线入户</p></li><li><p>光纤入户</p></li><li><p>家用无线路由器的逻辑结构</p><p>相当于里面有一个小型交换机，这就解释了为什么家用路由器连接后都属于同一个私网网段（LAN）</p></li></ol><h1 id=公网vs私网>公网Vs私网</h1><p>先看一下ABCD类地址</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl><span class=c1># A类地址：0开头</span>
</span></span><span class=line><span class=cl>00000000:00000000:00000000:00000000	-&gt; 0.0.0.0	<span class=c1># 不使用</span>
</span></span><span class=line><span class=cl>00000001:00000000:00000000:00000000 -&gt; 1.0.0.0
</span></span><span class=line><span class=cl>........
</span></span><span class=line><span class=cl>01111111:11111111:11111111:11111111	-&gt; 127.255.255.255 <span class=o>(</span><span class=nv>127</span><span class=o>=</span>255-2^7<span class=o>=</span>255-128<span class=o>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># B类地址：10开头</span>
</span></span><span class=line><span class=cl>10000000:00000000:00000000:00000000 -&gt; 128.0.0.0
</span></span><span class=line><span class=cl>10000000:00000000:00000000:00000001 -&gt; 128.0.0.1
</span></span><span class=line><span class=cl>......
</span></span><span class=line><span class=cl>10111111:11111111:11111111:11111111 -&gt; 191.255.255.255 <span class=o>(</span><span class=nv>191</span><span class=o>=</span>255-2^6<span class=o>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># C类地址：110开头</span>
</span></span><span class=line><span class=cl>11000000:00000000:00000000:00000000 -&gt; 192.0.0.0
</span></span><span class=line><span class=cl>11000000:00000000:00000000:00000001 -&gt; 192.0.0.1
</span></span><span class=line><span class=cl>......
</span></span><span class=line><span class=cl>11011111:11111111:11111111:11111111 -&gt; 223.255.255.255 <span class=o>(</span><span class=nv>223</span><span class=o>=</span>255-2^5<span class=o>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># D类地址：1110开头</span>
</span></span><span class=line><span class=cl>11100000:00000000:00000000:00000000 -&gt; 224.0.0.0
</span></span><span class=line><span class=cl>......
</span></span><span class=line><span class=cl>11101111:11111111:11111111:11111111 -&gt; 239.255.255.255 <span class=o>(</span><span class=nv>239</span><span class=o>=</span>255-2^4<span class=o>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># E类地址：11110开头</span>
</span></span><span class=line><span class=cl>11110000:00000000:00000000:00000000 -&gt; 240.0.0.0
</span></span><span class=line><span class=cl>......
</span></span><span class=line><span class=cl>11111111.11111111.11111111.11111111 -&gt; 255.255.255.255
</span></span></code></pre></td></tr></table></div></div><h2 id=公网>公网</h2><ol><li>Internet 上的路由器只有到达公网的路由表，没有到达私网的路由表</li><li>公网IP由因特网信息中心（Inter NIC）统一分配和管理</li><li>ISP需要向Inter NIC申请公网IP</li></ol><h2 id=私网>私网</h2><ol><li><p>主要用于局域网，下面是几个保留的私网网段</p><p><strong>A类：10.0.0.0/8</strong></p><p><strong>B类：172.16.0.0/16 - 172.32.0.0/16</strong></p><p><strong>C类：192.168.0.0/24 - 192.168.255.0/24</strong></p></li></ol><h2 id=nat>NAT</h2><ol><li><p>私网IP访问 Internet 需要进行 NAT 转化为公网IP</p><p>NAT（Network Address Translation）转化</p><p>这一步由路由器完成</p></li><li><p>NAT 特点</p><p>可以节约公网IP</p><p>会隐藏内部真实IP</p></li><li><p>NAT 分类</p><ul><li><p>静态转换（一对一转换）</p><p>手动配置 NAT 映射表</p><p>比如私网A映射成公网A，私网B映射成公网B</p></li><li><p>动态转化（一对一转换）</p><p>定义外部地址池，动态随机转换</p></li><li><p>PAT（Port Address Translation）（多对一）</p><p>采用端口多路复用方式，通过端口号标识不同的数据流</p><p>目前应用最广泛的NAT实现方式</p></li></ul><blockquote><p>一对一的方式并不能节约公网IP，还是一个私网对应一个公网，而多对一的方式能够实现一个公网对应多个私网，那么它的实现方式简单说就是每个私网IP对应公网IP的一个端口，进而实现端口多路复用</p></blockquote></li></ol><h1 id=网络分层>网络分层</h1><ol><li><p>网络请求过程，每层加上自己的一些信息，比如首部和尾部</p></li><li><p>5 层参考模型</p></li></ol><h2 id=物理层>物理层</h2><ol><li><p>物理层定义了<strong>接口标准，线缆标准，传输方式，传输速率</strong>等</p></li><li><p>数字信号（Digital Signal） Vs 模拟信号（Analog Signal）</p><ul><li>模拟信号适合长距离传输，但是抗干扰能力差，受到干扰变形很难矫正</li><li>数字信号频率高，衰减快，不适合长距离传输，但是抗干扰能力强，受到干扰后波形失真可以修复</li></ul></li><li><p>数据通信模型</p></li><li><p>信道（Channel）</p></li></ol><h2 id=数据链路层>数据链路层</h2><h3 id=链路>链路</h3><ol><li><p>链路：从一个节点到相邻节点的一段物理线路（有线/无线），中间没有其他交换节点</p><p>这里集线器只是起到数据转发，没有对数据进行任何处理，因此它并不是一个交换节点</p><p>而交换机会对数据做处理，交换机内部存有 MAC 地址表，能够知道数据传给谁</p><blockquote><p>集线器是一种将多个计算机或网络设备连接在一起的网络设备，它可以加强信号并将数据从一个端口转发到另一个端口。在集线器中，所有设备都连接在同一个物理链路上，这意味着所有设备共享相同的网络带宽和碰撞域。</p><p>由于集线器只是简单地将来自一个端口的数据复制到所有其他端口，因此集线器两端被视为同一链路。当一个设备发送数据到集线器时，集线器会将该数据广播到所有其他端口，因此该数据可以被连接到该集线器的任何其他设备接收。因此，在集线器中，所有设备都处于同一逻辑链路上，即它们共享相同的广播域和碰撞域。</p></blockquote><blockquote><p>下面两个链路的网络都是以太网（Ethernet），它传输的是以太网帧</p><p>计算机0-路由器0：使用了CSMA/CD协议，传输的帧称为以太网帧</p><p>计算机1-路由器2：用交换机组建的网络，支持全双工通信，不需要使用CSMA/CD协议，但传输的帧依然是以太网帧</p></blockquote><blockquote><p>注意：路由器0与路由器1（直连）之间走的是PPP协议帧，PPP协议不需要源MAC和目标MAC，如果路由器0与路由器1之间有一个交换机（比如下图），那么他们之间的两条链路走的就不是PPP协议了，是以太网帧，也就是说，还存在源MAC和目标MAC</p></blockquote></li><li><p>数据链路：<strong>在一条链路上传输数据时，需要有对应的传输协议来控制数据的传输</strong></p><p>比如：广播信道的CSMA/CD协议（同轴电缆、集线器组成的网络）、点对点信道的PPP协议（比如两个路由器之间的链路）</p><p>虽然数据链路都会把IP数据包加上首部和尾部，但是根据数据链路层协议的不同（比如PPP协议与CSMA/CD协议）加入的首部和尾部也不相同。</p><blockquote><p>这里举个例子，比如上图中计算机0要给计算机1发送数据，首先在计算机0与路由器0之间使用的是以太网技术，假设用的是CSMA/CD协议，那么计算机0与路由器0之间的链路就会在IP数据包的基础上加上首部和尾部，加上属于CSMA/CD协议的首部和尾部，链路层封装好的数据在交给物理层处理，传输到路由器0后，路由器0会将数据解封装即将之前对IP数据包封装的首部和尾部去掉，直到得到IP数据包为止，由于路由器之间传输数据是用的另外一个协议，假设使用的是PPP协议，那么此时路由器0会将解封装得到的IP数据包加上PPP协议的首部和尾部，之后物理层处理后发送给路由器1，然后重复上述过程，直到将数据传送到计算机1为止</p></blockquote></li><li><p>数据链路层的 3 个基本问题</p><ul><li><p>封装成帧</p><p>数据链路层会将 IP 数据包的两端加上帧首部和帧尾部</p><p>帧的数据部分是网络层传下来的 IP 数据包（Packet）</p><p>最大传输单元（Maximum Transfer Unit）：每一种数据链路协议都规定了能够传送帧的数据长度上限，以太网的 MTU 是 1500 Byte</p></li><li><p>透明传输</p><p>如果数据部分出现了帧结束符/帧开始符，那么接收端就会认为该处是帧结束符/帧开始符，这样就会出现问题。解决方法可以让数据部分不可能出现帧结束符/帧开始符，即数据部分一旦出现了 SOH/EOT，就对他们进行转义，在 IP 数据包中的 SOH/EOT/ESC 字符前面插入转义字符 ESC</p></li><li><p>差错检验</p><p>FCS 是根据帧数据部分和数据链路层首部计算得出的，如果接收端用同样的方法得出的 FCS 与数据帧中的 FCS 不匹配，那么网卡就会丢弃该帧数据，这也就是为什么抓包工具看不到 FCS 数据，因为出错的都被网卡丢弃了</p></li></ul></li></ol><h3 id=网卡>网卡</h3><p><img class=lazyload src=/svg/loading.min.svg data-src=https://ming-blog.oss-cn-shenzhen.aliyuncs.com/image/blog_img/image-20230322154129656.png data-srcset="https://ming-blog.oss-cn-shenzhen.aliyuncs.com/image/blog_img/image-20230322154129656.png, https://ming-blog.oss-cn-shenzhen.aliyuncs.com/image/blog_img/image-20230322154129656.png 1.5x, https://ming-blog.oss-cn-shenzhen.aliyuncs.com/image/blog_img/image-20230322154129656.png 2x" data-sizes=auto alt=https://ming-blog.oss-cn-shenzhen.aliyuncs.com/image/blog_img/image-20230322154129656.png title=image-20230322154129656></p><h3 id=csmacd协议>CSMA/CD协议</h3><h3 id=ethernet-v2帧>Ethernet V2帧</h3><ol><li><p>格式</p><p>首部：源MAC地址+目标MAC地址+类型</p><p>尾部：FCS</p><p>以太网帧：首部+尾部+数据</p><p>数据的长度至少是 64-6-6-2-4=46B</p><blockquote><p>为什么Ethernet V2没有帧开始符和帧结束符：以太网V2使用曼彻斯特编码，接收端接收帧的过程中只要发现没有信号跳变，就认为帧结束</p></blockquote></li><li><p>当数据部分少于46B时</p><p>数据链路层会在IP数据包后面添加一些字节用来填充</p><p>接收端会将填充的字节去掉</p></li><li><p>长度总结</p><p>以太网帧的数据长度（IP数据包长度）：46B~1500B</p><p>以太网帧长度：64B~1518B（源MAC地址+目标MAC地址+网络类型+IP数据包+FCS）</p></li></ol><h3 id=ppp协议>PPP协议</h3><ol><li><p>帧格式</p></li><li><p>字节填充</p><p><img class=lazyload src=/svg/loading.min.svg data-src=https://ming-blog.oss-cn-shenzhen.aliyuncs.com/image/blog_img/image-20230322152958539.png data-srcset="https://ming-blog.oss-cn-shenzhen.aliyuncs.com/image/blog_img/image-20230322152958539.png, https://ming-blog.oss-cn-shenzhen.aliyuncs.com/image/blog_img/image-20230322152958539.png 1.5x, https://ming-blog.oss-cn-shenzhen.aliyuncs.com/image/blog_img/image-20230322152958539.png 2x" data-sizes=auto alt=https://ming-blog.oss-cn-shenzhen.aliyuncs.com/image/blog_img/image-20230322152958539.png title=image-20230322152958539></p></li></ol><h2 id=网络层>网络层</h2><ol><li><p>网络层首部</p><p>网络层数据包（IP数据包，Packet）由首部、数据两部分组成</p><p>数据部分：<strong>很多时候</strong>是由传输层传递下来的数据段（Segment）</p><p>因为有些协议只是工作在最下面三层，比如 ARP 协议，IP 协议，ICMP 协议，这些都不属于运输层</p></li><li><p>版本：占4位</p><ul><li>IPV4：0b0100</li><li>IPV6：0b0110</li></ul></li><li><p>首部长度（Header Length）：占4位</p><p>如果首部没有可变部分，那么就首部就是占用了 20B（最小长度），对应该字段的值就是 0b0101，疑惑：0b0101不是等于十进制的 5 吗，没错，但是这个真实长度是需要乘以数字 4 的，也就是 4*5=20B</p><p>那么 4bit 的最大二进制是 0b1111=15，也就是 60B（最大长度）</p></li><li><p>区分服务（Differentiated Services Field）：占8位，可以用于提高网络的服务质量（Qos）</p></li><li><p>总长度（Total Length）：占 16位</p><p>网络层首部+数据的长度之和，最大是 2^16-1=65535B</p><p>之前学习数据链路层的帧，帧的数据部分，也就是IP数据包最大的长度MTU不可超过 1500B，那么如果上层传输层传过来的数据加上网络层的首部超过 1500B 怎么办？</p><p>如果IP数据包超过 1500B 就会进行<strong>分片（fragments）<strong>处理，将每个分片</strong>单独加上网络层的首部</strong>传输给数据链路层，一些分片到了数据链路层怎么将他们组合起来传递给网络层呢？这就设计到首部的一些数据字段了</p></li><li><p>标识（Identification）：占16位</p><p>数据包的ID，当数据包过大进行分片，<strong>同一个数据包的所有片的标识都是一样的</strong></p><p>有一个计数器专门管理数据包的ID，每发出一个数据包，ID就加1</p></li><li><p>标志（Flags）：占3位</p><ul><li>第一位（Reserved Bit）：保留</li><li>第二位（Don’t Fragment）：1代表不允许分片，0代表允许分片</li><li>第三位（More Fragments）：1代表不是最后一片，0代表是最后一片</li></ul></li><li><p>片偏移（Fragment Offset）：占13位，最大二进制是 0b1111111111111=4095，故最大字节偏移 4095*8=32760B（31.992KB）</p><p>片偏移的值乘以 8 才是字节偏移</p><p>每一片的长度都是 8 的整数倍</p></li><li><p>生存时间（Time To Live）：占8位</p><p>每个路由器在转发之前都会将 TTL 减 1，一旦发现 TTL 减为 0 了，路由器会返回错误报告</p><p>为什么要设置这个字段：最通俗的解释就是路由器形成回路，不设置该字段数据就会一直占用带宽</p></li><li><p>协议（Protocol）：占8位</p><p>表明封装的数据是用的什么协议，数据由上层即运输层传下来</p><p><img class=lazyload src=/svg/loading.min.svg data-src=https://ming-blog.oss-cn-shenzhen.aliyuncs.com/image/blog_img/image-20230326202450239.png data-srcset="https://ming-blog.oss-cn-shenzhen.aliyuncs.com/image/blog_img/image-20230326202450239.png, https://ming-blog.oss-cn-shenzhen.aliyuncs.com/image/blog_img/image-20230326202450239.png 1.5x, https://ming-blog.oss-cn-shenzhen.aliyuncs.com/image/blog_img/image-20230326202450239.png 2x" data-sizes=auto alt=https://ming-blog.oss-cn-shenzhen.aliyuncs.com/image/blog_img/image-20230326202450239.png title=image-20230326202450239></p></li><li><p>首部校验和（Header Checksum）：由发送端填充，接收端对其使用 CRC 算法以检验 IP 数据报的头部（仅检验头部）在传输过程中是否损坏</p></li><li><p>32 位源地址和目标地址在整个数据报的传递过程中保持不变</p></li></ol><h3 id=书中摘要>书中摘要</h3><ol><li>当 IP 数据报（首部+数据）长度超过帧的 MTU 时，需要进行分片传输。分片可能发生在发送方也<strong>可能发生在中转路由器上</strong>，而且可能在传输过程中多次分片，<strong>但只有到目标机器上，这些分片才会被内核中的 IP 模块重新组装</strong></li><li></li></ol><h2 id=传输层>传输层</h2><p>传输层有两个协议</p><ul><li>TCP（Transmission Control Protocol）：传输控制协议</li><li>UDP（User Datagram Protocol）：用户数据报协议</li></ul><p><img class=lazyload src=/svg/loading.min.svg data-src=https://ming-blog.oss-cn-shenzhen.aliyuncs.com/image/blog_img/image-20230327190839010.png data-srcset="https://ming-blog.oss-cn-shenzhen.aliyuncs.com/image/blog_img/image-20230327190839010.png, https://ming-blog.oss-cn-shenzhen.aliyuncs.com/image/blog_img/image-20230327190839010.png 1.5x, https://ming-blog.oss-cn-shenzhen.aliyuncs.com/image/blog_img/image-20230327190839010.png 2x" data-sizes=auto alt=https://ming-blog.oss-cn-shenzhen.aliyuncs.com/image/blog_img/image-20230327190839010.png title=image-20230327190839010></p><h3 id=udp>UDP</h3><ol><li><p>UDP是无连接的，减少了建立和释放连接的开销</p></li><li><p>UDP是尽最大能力交付，不保证可靠交付</p></li><li><p>UDP协议的格式，首部只有8个字节（TCP的首部至少20个字节）</p></li><li><p>UDP长度：UDP首部+数据长度</p></li><li><p>UDP检验和��Checksum）：需要利用伪首部+首部+数据三部分计算出</p><p>伪首部（12字节）：仅仅在计算检验和时起作用，并不传给网络层，增加伪首部能提高安全性，检错能力更强</p></li><li><p>端口（Port）：占2字节，端口的取值范围是 0~65535</p><p>客户端的源端口是临时开启的随机端口，用完之后就释放</p><p>下面是一些程序的默认端口</p></li><li></li></ol><h1 id=网络安全>网络安全</h1><h2 id=http协议安全问题>HTTP协议安全问题</h2><ol><li><p>HTTP 协议的安全问题</p></li><li><p>先认识几个英文</p><ul><li>encrypt：加密</li><li>decrypt：解密</li><li>plaintext：明文</li><li>ciphertext：密文</li></ul></li><li><p>虚拟人物</p></li><li><p>防止被窃听</p><p><img class=lazyload src=/svg/loading.min.svg data-src=https://ming-blog.oss-cn-shenzhen.aliyuncs.com/image/blog_img/image-20230428220520433.png data-srcset="https://ming-blog.oss-cn-shenzhen.aliyuncs.com/image/blog_img/image-20230428220520433.png, https://ming-blog.oss-cn-shenzhen.aliyuncs.com/image/blog_img/image-20230428220520433.png 1.5x, https://ming-blog.oss-cn-shenzhen.aliyuncs.com/image/blog_img/image-20230428220520433.png 2x" data-sizes=auto alt=https://ming-blog.oss-cn-shenzhen.aliyuncs.com/image/blog_img/image-20230428220520433.png title=image-20230428220520433></p></li></ol><h3 id=不可逆加密>不可逆加密</h3><h4 id=单向散列函数>单向散列函数</h4><ol><li><p>单向散列函数，可以根据消息内容计算出散列值</p></li><li><p>散列值的长度和消息的长度无关，无论消息是 1bit、10M、100G 甚至更大，单向散列函数都会计算出固定长度的散列值</p><p>无法通过散列值推算内容</p></li><li><p>特点</p><ul><li><p>根据任意长度的消息，计算出固定长度的散列值</p></li><li><p>计算速度快，能够快速计算出散列值</p></li><li><p>消息不同，散列值也不同</p></li><li><p>具备单向性</p></li></ul></li><li><p>单向散列函数也称为</p><ul><li>消息摘要函数（message digest function）</li><li>哈希函数（hash function）</li></ul></li><li><p>输出的散列值也称为</p><ul><li>消息摘要（message digest）</li><li>指纹（fingerprint）</li></ul></li><li><p>常见的几种单向散列函数</p><ul><li><p>MD4、MD5：能够产生 128 bit 的散列值，MD 即 Message Digest 的缩写，目前已经不安全</p><blockquote><p>MD5 是一种哈希算法，它将任意长度的数据映射成一个固定长度的输出。MD5 哈希值通常表示为 32 位十六进制数字。因为哈希函数是单向的，并且有可能存在相同的哈希值（所谓的哈希冲突），因此暴力破解 MD5 哈希值是非常困难的。</p><p>通常，暴力破解 MD5 哈希值需要枚举所有可能的输入字符串并计算其哈希值，直到找到与目标哈希值匹配的输入字符串。由于 MD5 哈希值长度为 32 位，因此可以理论上有 16321632 种可能的输入字符串，所以暴力破解 MD5 哈希值需要极长的时间和计算资源。</p><p>实际上，通过使用一些对称密钥算法的技术（如彩虹表，字典攻击等），可以加速 MD5 哈希值的暴力破解。但是，这仍然需要大量的时间和计算资源，具体取决于要破解的哈希值和攻击者的计算能力。</p><p>总的来说，暴力破解 MD5 哈希值需要的时间和计算资源取决于许多因素，包括哈希值长度、密码复杂度、攻击者计算能力等等，因此很难给出一个确切的答案。</p></blockquote></li><li><p>SHA-1：产生 160 bit 的散列值，目前已经不安全</p></li><li><p>SHA-2：SHA-256、SHA-384、SHA-512，散列长度分别是 256 bit、384 bit、512 bit</p></li><li><p>SHA-3：全新标准</p></li></ul></li><li><p>单向散列函数的应用</p><ul><li>检测 应用被篡改，比如一些网站下载软件会提供一串散列值，下载到本地后通过对应的散列函数计算出散列值与官网给出的散列值对比</li><li>密码加密：比如前端输入密码先将密码加密在传给后端，后端加盐在存储到数据库中</li></ul></li></ol><h3 id=可逆加密>可逆加密</h3><p>如何加密解密</p><p>不管是对称加密和非对称加密，都需要加密算法和密钥</p><h4 id=对称加密symmetric-cryptography>对称加密(Symmetric Cryptography)</h4><p>对称加密也称<strong>对称密码</strong></p><p>加密和解密的密钥是相同的</p><p>DES、3DES、AES等</p><h5 id=des>DES</h5><p>英文：Data Encryption Algorithm</p><p><img class=lazyload src=/svg/loading.min.svg data-src=https://ming-blog.oss-cn-shenzhen.aliyuncs.com/image/blog_img/image-20230428231500249.png data-srcset="https://ming-blog.oss-cn-shenzhen.aliyuncs.com/image/blog_img/image-20230428231500249.png, https://ming-blog.oss-cn-shenzhen.aliyuncs.com/image/blog_img/image-20230428231500249.png 1.5x, https://ming-blog.oss-cn-shenzhen.aliyuncs.com/image/blog_img/image-20230428231500249.png 2x" data-sizes=auto alt=https://ming-blog.oss-cn-shenzhen.aliyuncs.com/image/blog_img/image-20230428231500249.png title=image-20230428231500249></p><h5 id=3des>3DES</h5><p>英文：Triple Data Encryption Algorithm</p><p><img class=lazyload src=/svg/loading.min.svg data-src=https://ming-blog.oss-cn-shenzhen.aliyuncs.com/image/blog_img/image-20230428231647986.png data-srcset="https://ming-blog.oss-cn-shenzhen.aliyuncs.com/image/blog_img/image-20230428231647986.png, https://ming-blog.oss-cn-shenzhen.aliyuncs.com/image/blog_img/image-20230428231647986.png 1.5x, https://ming-blog.oss-cn-shenzhen.aliyuncs.com/image/blog_img/image-20230428231647986.png 2x" data-sizes=auto alt=https://ming-blog.oss-cn-shenzhen.aliyuncs.com/image/blog_img/image-20230428231647986.png title=image-20230428231647986></p><p><img class=lazyload src=/svg/loading.min.svg data-src=https://ming-blog.oss-cn-shenzhen.aliyuncs.com/image/blog_img/image-20230428231835674.png data-srcset="https://ming-blog.oss-cn-shenzhen.aliyuncs.com/image/blog_img/image-20230428231835674.png, https://ming-blog.oss-cn-shenzhen.aliyuncs.com/image/blog_img/image-20230428231835674.png 1.5x, https://ming-blog.oss-cn-shenzhen.aliyuncs.com/image/blog_img/image-20230428231835674.png 2x" data-sizes=auto alt=https://ming-blog.oss-cn-shenzhen.aliyuncs.com/image/blog_img/image-20230428231835674.png title=image-20230428231835674></p><p>EDE3：E是加密（Encryption）的首字母，D 是解密（Decryption）的首字母，3 代表 3 个不同的密钥</p><p>如果所有密钥都是相同的，那么结果与普通的 DES 是等价的</p><p>如果密钥1、密钥3相同，密钥2不同，称为 DES-EDE2</p><h5 id=aes>AES</h5><p>英文：Advanced Encryption Standard</p><ol><li>取代 DES 成为新标准的一种<strong>对称加密算法</strong>，又称为 Rijndael 算法（作者名字）</li><li>AES 的密钥长度有 128、192、256 bit 三种</li><li>目前 AES 已经逐步取代 DES、3DES，成为首选的加密算法</li></ol><h5 id=密钥配送问题>密钥配送问题</h5><p>在使用对称加密时，一定会遇到密钥配送问题</p><p>下图表示窃听者窃听到了密钥和密文，能够解密出来</p><p>有下面几种方法解决密钥配送问题</p><ul><li>事先共享密钥（私下共享&mldr;）</li><li>密钥配送中心（简称 KDC）</li><li>Diffie-Hellman 密钥交换</li><li>非对称加密，密钥配送步骤如下<ul><li>由消息的接收者生成一对公钥、私钥</li><li>将公钥发给消息的发送者</li><li>消息发送者使用公钥将对称加密的密钥进行加密</li><li>将密文发送给接收者，接受者通过私钥解密得到对称加密的密钥</li></ul></li></ul><h4 id=非对称加密asymmetric-cryptography>非对称加密(Asymmetric Cryptography)</h4><p>非对称加密也称<strong>公钥密码</strong></p><p>加密用的密钥和解密用的密钥不是相同的</p><p>在非对称加密中，密钥分为<strong>加密密钥</strong>、<strong>解密密钥</strong> 2 种，他们并不是同一个密钥</p><ol><li><p><strong>加密密钥</strong>：一般是公开的，称为公钥（public key）</p><p>因此，<strong>非对称加密</strong>也被称为<strong>公钥密码</strong>（Public-key Cryptography）</p></li><li><p><strong>解密密钥</strong>：由接受者自己保管，不能公开，称为私钥（Private key）</p></li></ol><p><img class=lazyload src=/svg/loading.min.svg data-src=https://ming-blog.oss-cn-shenzhen.aliyuncs.com/image/blog_img/image-20230428234511698.png data-srcset="https://ming-blog.oss-cn-shenzhen.aliyuncs.com/image/blog_img/image-20230428234511698.png, https://ming-blog.oss-cn-shenzhen.aliyuncs.com/image/blog_img/image-20230428234511698.png 1.5x, https://ming-blog.oss-cn-shenzhen.aliyuncs.com/image/blog_img/image-20230428234511698.png 2x" data-sizes=auto alt=https://ming-blog.oss-cn-shenzhen.aliyuncs.com/image/blog_img/image-20230428234511698.png title=image-20230428234511698></p><h5 id=公钥私钥>公钥、私钥</h5><ol><li><p>公钥和私钥是一一对应的，不能单独生成</p><p>一对公钥和私钥统称为密钥对（key pair）</p></li><li><p>由公钥加密的密文，必须使用该公钥对应的私钥才能解密</p></li><li><p>由私钥加密的密文，必须使用该私钥对应的公钥才能解密，应用：数字签名</p></li></ol><p>下面这幅图解释了 2 和 3 两点，注意：右边是数字签名</p><h5 id=公钥的合法性>公钥的合法性</h5><p>上面提到，通过接收者的公钥进行加密消息，然后发送者发送给接收者，接受者用对应的私钥进行解密，假如中间有个窃听者呢，那么他就可以在中间做文章了，比如伪造公钥，具体看图</p><p><img class=lazyload src=/svg/loading.min.svg data-src=https://ming-blog.oss-cn-shenzhen.aliyuncs.com/image/blog_img/image-20230429142852463.png data-srcset="https://ming-blog.oss-cn-shenzhen.aliyuncs.com/image/blog_img/image-20230429142852463.png, https://ming-blog.oss-cn-shenzhen.aliyuncs.com/image/blog_img/image-20230429142852463.png 1.5x, https://ming-blog.oss-cn-shenzhen.aliyuncs.com/image/blog_img/image-20230429142852463.png 2x" data-sizes=auto alt=https://ming-blog.oss-cn-shenzhen.aliyuncs.com/image/blog_img/image-20230429142852463.png title=image-20230429142852463></p><p>那么就引出了公钥的合法性问题，解决方法是证书，下面提及</p><h5 id=通信举例>通信举例</h5><ol><li><p>通过公钥加密，私钥解密</p><p>比如 A、B、C、D 给 E 发送数据，发送者会用后者接收方 E 的公钥对数据加密，之后发送给 E，E 接受到后用对应的私钥进行解密，即使网络窃听者窃取到密文也无法解密，因为公钥对应的私钥只有 E 有，这种加密方式就避免了密钥在网络上的配送问题，但是通过公钥加密，私钥解密是比较复杂的，效率当然没有对称加密那么高，但是安全性好</p></li><li><p>通过私钥加密，公钥解密</p><p>上面提到了发送数据给 E，那么反过来，E 想发数据给 A 怎么发，用同样的方法，E 用 A 的公钥进行加密然后把密文发送给 A，A 用对应的私钥进行解密即可。但是还有一种方法，即 E 用自己的私钥进行加密，将密文发送给 A，A 用对应的公钥进行解密，一样可以达到 E 发送数据给 A。可能会有疑问，E 的公钥谁都可以获取到，那么这样岂不是跟没加密一样吗？后面的数字签名将会应用到</p></li></ol><h5 id=rsa>RSA</h5><ol><li>目前使用最广泛的非对称加密算法是 RSA</li><li>RSA 的名字，是 3 位开发者的姓氏首字母组成</li></ol><h4 id=对称加密与非对称加密>对称加密与非对称加密</h4><ol><li>非对称加密：复杂 -> 安全 -> 加密解密慢</li><li>对称解密：简单 -> 不安全 -> 加密解密快</li></ol><h4 id=混合密码>混合密码</h4><p>为了解决对称加密和非对称加密的各自缺点，达到效率更高的加密方法，<strong>使用了对称加密和非对称加密</strong></p><ol><li><p>会话密钥（session key）</p><ul><li>为本次通信随机生成的临时密钥</li><li>作为<strong>对称加密</strong>的密钥，用于加密消息，提高速度</li></ul></li><li><p>加密步骤（发送消息）</p><ul><li>首先，消息发送者要拥有消息接受者的公钥</li><li>生成会话密钥，作为对称加密的密钥，用于加密消息内容主体</li><li>用消息接受者的公钥，加密会话密钥</li><li>将前两部生成的密钥结果，一并发送给消息接受者</li><li>接受者接受到消息，用自己的私钥解密公钥加密的会话密钥内容，得到会话密钥，再用会话密钥解密消息密文（此时是对称加密）</li></ul></li><li><p>因此发送出去的内容包括</p><ul><li>用会话密钥加密的消息（加密方法：<strong>对称加密</strong>）</li><li>用公钥加密的会话密钥（加密方法：<strong>非对称加密</strong>）</li></ul></li><li><p>举例，Alice 发送消息给 Bob 的过程</p></li></ol><h3 id=数字签名>数字签名</h3><p>数字签名并不是加密，而是解决数据的可靠性问题，即这个消息的确是发送者发的，而不是别人伪装发送者发的，或者篡改发送者的消息</p><p>数字签名的过程，这个过程是对整个消息用私钥进行加密，但是私钥进行加密解密速度会比价慢，改进方法看下面</p><p>对数字签名过程进行改进，这一种方法是将消息通过单向散列函数得到一串散列值，再对散列值用私钥进行加密（也即签名），这样就解决了对过多消息内容进行签名的性能缺陷</p><p>数字签名的完整过程</p><p>数字签名疑惑</p><p>数字签名是不是很像将非对称加密反过来用</p><p>在非对称加密中，发送者需要拥有接受者的公钥</p><p>在数字签名中，发送者需要拥有自己的私钥</p><h3 id=证书>证书</h3><p>能够解决公钥合法性问题</p><p><img class=lazyload src=/svg/loading.min.svg data-src=https://ming-blog.oss-cn-shenzhen.aliyuncs.com/image/blog_img/image-20230429144642724.png data-srcset="https://ming-blog.oss-cn-shenzhen.aliyuncs.com/image/blog_img/image-20230429144642724.png, https://ming-blog.oss-cn-shenzhen.aliyuncs.com/image/blog_img/image-20230429144642724.png 1.5x, https://ming-blog.oss-cn-shenzhen.aliyuncs.com/image/blog_img/image-20230429144642724.png 2x" data-sizes=auto alt=https://ming-blog.oss-cn-shenzhen.aliyuncs.com/image/blog_img/image-20230429144642724.png title=image-20230429144642724></p><h4 id=证书的使用过程>证书的使用过程</h4><p><strong>只要签名是假的 那么公钥就不能解密</strong> 因为只有私钥加密的 公钥才能解密 私钥只有认证机构知道 而且验证证书的时候只会用认证机构的公钥 所以认证机构的签名不可能做假</p><p><img class=lazyload src=/svg/loading.min.svg data-src=https://ming-blog.oss-cn-shenzhen.aliyuncs.com/image/blog_img/image-20230429145519237.png data-srcset="https://ming-blog.oss-cn-shenzhen.aliyuncs.com/image/blog_img/image-20230429145519237.png, https://ming-blog.oss-cn-shenzhen.aliyuncs.com/image/blog_img/image-20230429145519237.png 1.5x, https://ming-blog.oss-cn-shenzhen.aliyuncs.com/image/blog_img/image-20230429145519237.png 2x" data-sizes=auto alt=https://ming-blog.oss-cn-shenzhen.aliyuncs.com/image/blog_img/image-20230429145519237.png title=image-20230429145519237></p><h4 id=证书的注册和下载>证书的注册和下载</h4><p><img class=lazyload src=/svg/loading.min.svg data-src=https://ming-blog.oss-cn-shenzhen.aliyuncs.com/image/blog_img/image-20230429145724344.png data-srcset="https://ming-blog.oss-cn-shenzhen.aliyuncs.com/image/blog_img/image-20230429145724344.png, https://ming-blog.oss-cn-shenzhen.aliyuncs.com/image/blog_img/image-20230429145724344.png 1.5x, https://ming-blog.oss-cn-shenzhen.aliyuncs.com/image/blog_img/image-20230429145724344.png 2x" data-sizes=auto alt=https://ming-blog.oss-cn-shenzhen.aliyuncs.com/image/blog_img/image-20230429145724344.png title=image-20230429145724344></p><h2 id=https>HTTPS</h2><ul><li>HTTPS(<strong>HyperText Transfer Protocol Secure</strong>)：超文本传输安全协议，由网景公司于1994年首次提出</li><li>常成为：HTTP over TLS、HTTP over SSL、HTTP Secure</li><li>使用了HTTPS服务，服务端与客户端传输的所有内容都是加密的（比如请求体、响应头、响应体等）</li></ul><h3 id=ssltls>SSL/TLS</h3><ul><li>TLS(<strong>Transport Layer Security</strong>)：传输层安全性协议</li><li>SSL(<strong>Secure Sockets Layer</strong>)：安全套接层</li></ul><blockquote><p>SSL/TLS 工作在哪一层</p></blockquote><p>HTTP 工作在应用层，HTTPS 对数据加密，但是加密后还是需要递交给下一层的传输层，所以加密的行为是在应用层基础并在传输层之前，所以 SSL/TLS 工作在应用层和传输层之间</p><h3 id=openssl>OpenSSL</h3><ul><li>OpenSSL 是 SSL/TLS 协议的开源实现，支持 Windows、Linux、Mac 等平台<ul><li>Linux、Mac 一般自带 OpenSSL</li></ul></li></ul><p>如在 Linux 下使用 OpenSSL 生成一个私钥</p><h3 id=成本>成本</h3><h3 id=heading></h3><h1 id=引用>引用</h1><ol><li><a href="https://www.bilibili.com/video/BV1Fy4y1Y7n6?t=7814.0&amp;p=17" target=_blank rel="noopener noreffer">https://www.bilibili.com/video/BV1Fy4y1Y7n6?t=7814.0&p=17</a></li><li><a href="https://www.bilibili.com/video/BV1Fy4y1Y7n6?t=7412.2&amp;p=18" target=_blank rel="noopener noreffer">https://www.bilibili.com/video/BV1Fy4y1Y7n6?t=7412.2&p=18</a></li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>curl https://api.openai.com/v1/models <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  -H <span class=s2>&#34;Authorization: Bearer </span><span class=nv>$OPENAI_API_KEY</span><span class=s2>&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  -H <span class=s2>&#34;OpenAI-Organization: org-yfxKET4BhWsFbmaEsfqNnVtB&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>curl https://api.openai.com/v1/chat/completions <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  -H <span class=s2>&#34;Content-Type: application/json&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  -H <span class=s2>&#34;Authorization: Bearer </span><span class=nv>$OPENAI_API_KEY</span><span class=s2>&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  -d <span class=s1>&#39;{
</span></span></span><span class=line><span class=cl><span class=s1>     &#34;model&#34;: &#34;gpt-3.5-turbo&#34;,
</span></span></span><span class=line><span class=cl><span class=s1>     &#34;messages&#34;: [{&#34;role&#34;: &#34;user&#34;, &#34;content&#34;: &#34;Say this is a test!&#34;}],
</span></span></span><span class=line><span class=cl><span class=s1>     &#34;temperature&#34;: 0.7
</span></span></span><span class=line><span class=cl><span class=s1>   }&#39;</span>
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>ppp0      Link encap:Point-to-Point Protocol
</span></span><span class=line><span class=cl>          inet addr:223.145.169.186  P-t-P:223.145.168.1  Mask:255.255.255.255
</span></span><span class=line><span class=cl>          UP POINTOPOINT RUNNING NOARP MULTICAST  MTU:1492
</span></span><span class=line><span class=cl>          RX packets:1927363 errors:0 dropped:0 overruns:0 frame:0
</span></span><span class=line><span class=cl>          TX packets:1327515 errors:0 dropped:0 overruns:0 carrier:0
</span></span><span class=line><span class=cl>          collisions:0 txqueuelen:3
</span></span><span class=line><span class=cl>          RX bytes:1980896866 <span class=o>(</span>1.8 GiB<span class=o>)</span>  TX bytes:446459702 <span class=o>(</span>425.7 MiB<span class=o>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>这是 ppp0 网络接口的配置信息。其中，各字段的含义如下：
</span></span><span class=line><span class=cl>- Link encap：连接类型，这里是 PPP（Point-to-Point Protocol）协议。
</span></span><span class=line><span class=cl>- inet addr：网络地址，这里是 223.145.169.186。
</span></span><span class=line><span class=cl>- P-t-P：点对点地址，这里是 223.145.168.1。
</span></span><span class=line><span class=cl>- Mask：子网掩码，这里是 255.255.255.255，表示没有子网划分。
</span></span><span class=line><span class=cl>- UP：接口状态，表示该接口当前处于启动状态。
</span></span><span class=line><span class=cl>- POINTOPOINT：连接类型，与 Link encap 字段相同，都是 PPP 协议。
</span></span><span class=line><span class=cl>- RUNNING：接口运行状态。
</span></span><span class=line><span class=cl>- NOARP：地址解析协议（ARP）状态，表示不进行 ARP 处理。
</span></span><span class=line><span class=cl>- MULTICAST：多播状态。
</span></span><span class=line><span class=cl>- MTU：最大传输单元，指该接口支持的数据包最大大小。
</span></span><span class=line><span class=cl>- RX packets：接收数据包数量。
</span></span><span class=line><span class=cl>- errors：接收错误数。
</span></span><span class=line><span class=cl>- dropped：丢弃的数据包数量。
</span></span><span class=line><span class=cl>- overruns：接收缓冲区溢出次数。
</span></span><span class=line><span class=cl>- frame：损坏的数据帧数量。
</span></span><span class=line><span class=cl>- TX packets：发送数据包数量。
</span></span><span class=line><span class=cl>- carrier：发送过程中发生的错误数。
</span></span><span class=line><span class=cl>- collisions：冲突数。
</span></span><span class=line><span class=cl>- txqueuelen：传输队列长度。
</span></span><span class=line><span class=cl>- RX bytes：接收字节数。
</span></span><span class=line><span class=cl>- TX bytes：发送字节数。
</span></span></code></pre></td></tr></table></div></div></div><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span>Updated on 2023-03-18</span></div></div><div class=post-info-line><div class=post-info-md></div><div class=post-info-share><span><a href=javascript:void(0); title="Share on Twitter" data-sharer=twitter data-url=https://200928.github.io/posts/%E7%BD%91%E7%BB%9C%E5%8D%8F%E8%AE%AE/ data-title=网络协议 data-hashtags=HTTP,TCP,IP><i class="fab fa-twitter fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Facebook" data-sharer=facebook data-url=https://200928.github.io/posts/%E7%BD%91%E7%BB%9C%E5%8D%8F%E8%AE%AE/ data-hashtag=HTTP><i class="fab fa-facebook-square fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Hacker News" data-sharer=hackernews data-url=https://200928.github.io/posts/%E7%BD%91%E7%BB%9C%E5%8D%8F%E8%AE%AE/ data-title=网络协议><i class="fab fa-hacker-news fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Line" data-sharer=line data-url=https://200928.github.io/posts/%E7%BD%91%E7%BB%9C%E5%8D%8F%E8%AE%AE/ data-title=网络协议><i data-svg-src=https://cdn.jsdelivr.net/npm/simple-icons@7.3.0/icons/line.svg aria-hidden=true></i></a><a href=javascript:void(0); title="Share on 微博" data-sharer=weibo data-url=https://200928.github.io/posts/%E7%BD%91%E7%BB%9C%E5%8D%8F%E8%AE%AE/ data-title=网络协议><i class="fab fa-weibo fa-fw" aria-hidden=true></i></a></span></div></div></div><div class=post-info-more><section class=post-tags><i class="fas fa-tags fa-fw" aria-hidden=true></i>&nbsp;<a href=/tags/http/>HTTP</a>,&nbsp;<a href=/tags/tcp/>TCP</a>,&nbsp;<a href=/tags/ip/>IP</a></section><section><span><a href=javascript:void(0); onclick=window.history.back()>Back</a></span>&nbsp;|&nbsp;<span><a href=/>Home</a></span></section></div><div class=post-nav><a href=/posts/archlinux%E5%A4%96%E6%8E%A5%E6%98%BE%E7%A4%BA%E5%99%A8/ class=prev rel=prev title=ArchLinux外接显示器><i class="fas fa-angle-left fa-fw" aria-hidden=true></i>ArchLinux外接显示器</a>
<a href=/posts/%E5%BC%95%E7%94%A8%E4%BC%A0%E9%80%92/ class=next rel=next title=引用传递>引用传递<i class="fas fa-angle-right fa-fw" aria-hidden=true></i></a></div></div><div id=comments><div id=disqus_thread class=comment></div><noscript>Please enable JavaScript to view the comments powered by <a href=https://disqus.com/?ref_noscript>Disqus</a>.</noscript></div></article></div></main><footer class=footer><div class=footer-line><span id=run-time></span></div><div class=footer-container><div class=footer-line>Powered by <a href=https://gohugo.io/ target=_blank rel="noopener noreffer" title="Hugo 0.121.2">Hugo</a> | Theme - <a href=https://github.com/dillonzq/LoveIt target=_blank rel="noopener noreffer" title="LoveIt 0.2.11"><i class="far fa-kiss-wink-heart fa-fw" aria-hidden=true></i> LoveIt</a></div><div class=footer-line itemscope itemtype=http://schema.org/CreativeWork><i class="far fa-copyright fa-fw" aria-hidden=true></i><span itemprop=copyrightYear>2024</span><span class=author itemprop=copyrightHolder>&nbsp;<a href=/ target=_blank></a></span></div><script async src=//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js></script><section><span id=busuanzi_container_value_site_pv><i class="far fa-eye fa-fw"></i>
<span id=busuanzi_value_site_pv></span>
</span>&nbsp;|&nbsp;
<span id=busuanzi_container_value_site_uv><i class="fa fa-user"></i>
<span id=busuanzi_value_site_uv></span></span></section></div></footer></div><div id=fixed-buttons><a href=# id=back-to-top class=fixed-button title="Back to Top"><i class="fas fa-arrow-up fa-fw" aria-hidden=true></i>
</a><a href=# id=view-comments class=fixed-button title="View Comments"><i class="fas fa-comment fa-fw" aria-hidden=true></i></a></div><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/lightgallery@2.5.0/css/lightgallery-bundle.min.css><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/katex.min.css><script type=text/javascript src=https://.disqus.com/embed.js defer></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/autocomplete.js@0.38.1/dist/autocomplete.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/lunr@2.3.9/lunr.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/lazysizes@5.3.2/lazysizes.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/lightgallery@2.5.0/lightgallery.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/lightgallery@2.5.0/plugins/thumbnail/lg-thumbnail.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/lightgallery@2.5.0/plugins/zoom/lg-zoom.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/clipboard@2.0.11/dist/clipboard.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/sharer.js@0.5.1/sharer.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/katex.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/contrib/auto-render.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/contrib/copy-tex.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/contrib/mhchem.min.js></script><script type=text/javascript>window.config={code:{copyTitle:"Copy to clipboard",maxShownLines:50},comment:{},lightgallery:!0,math:{delimiters:[{display:!0,left:"$$",right:"$$"},{display:!0,left:"\\[",right:"\\]"},{display:!0,left:"\\begin{equation}",right:"\\end{equation}"},{display:!0,left:"\\begin{equation*}",right:"\\end{equation*}"},{display:!0,left:"\\begin{align}",right:"\\end{align}"},{display:!0,left:"\\begin{align*}",right:"\\end{align*}"},{display:!0,left:"\\begin{alignat}",right:"\\end{alignat}"},{display:!0,left:"\\begin{alignat*}",right:"\\end{alignat*}"},{display:!0,left:"\\begin{gather}",right:"\\end{gather}"},{display:!0,left:"\\begin{CD}",right:"\\end{CD}"},{display:!1,left:"$",right:"$"},{display:!1,left:"\\(",right:"\\)"}],strict:!1},search:{highlightTag:"em",lunrIndexURL:"/index.json",maxResultLength:10,noResultsFound:"No results found",snippetLength:30,type:"lunr"}}</script><script type=text/javascript src=/js/theme.min.js></script><script defer src=https://us.umami.is/script.js data-website-id=076a706b-b869-4daf-a0f4-6aa04b5620fa></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/jquery@2.1.3/dist/jquery.min.js></script><script type=text/javascript src=/js/custom.js></script></body></html>