<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>网络是怎样连接的 | 灰灰爱吃小云朵</title><meta name="keywords" content="书籍"><meta name="author" content="xiaofan"><meta name="copyright" content="xiaofan"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="从在浏览器中输入网址，到屏幕上显示出网页的内容，在这个只有几秒钟的过程中，很多硬件和软件都在各自的岗位上相互配合完成了一系列的工作。本书将以探索之旅的形式，带领大家探索这一系列工作中的每一个环节。每个单独的环节都并不复杂，只要仔细阅读就一定能够理解。不过，探索之旅中出现的硬件和软件数量庞大，如果仅从微观的视角关注每一个单独的点，可能就会因为看不到整体而迷失了方向。因此，在真正出发开始探索之前，">
<meta property="og:type" content="article">
<meta property="og:title" content="网络是怎样连接的">
<meta property="og:url" content="http://755400668.github.io/2021/09/27/%E7%BD%91%E7%BB%9C%E6%98%AF%E6%80%8E%E6%A0%B7%E8%BF%9E%E6%8E%A5%E7%9A%84/index.html">
<meta property="og:site_name" content="灰灰爱吃小云朵">
<meta property="og:description" content="从在浏览器中输入网址，到屏幕上显示出网页的内容，在这个只有几秒钟的过程中，很多硬件和软件都在各自的岗位上相互配合完成了一系列的工作。本书将以探索之旅的形式，带领大家探索这一系列工作中的每一个环节。每个单独的环节都并不复杂，只要仔细阅读就一定能够理解。不过，探索之旅中出现的硬件和软件数量庞大，如果仅从微观的视角关注每一个单独的点，可能就会因为看不到整体而迷失了方向。因此，在真正出发开始探索之前，">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg">
<meta property="article:published_time" content="2021-09-27T02:32:33.000Z">
<meta property="article:modified_time" content="2021-10-23T06:39:16.095Z">
<meta property="article:author" content="xiaofan">
<meta property="article:tag" content="书籍">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="http://755400668.github.io/2021/09/27/%E7%BD%91%E7%BB%9C%E6%98%AF%E6%80%8E%E6%A0%B7%E8%BF%9E%E6%8E%A5%E7%9A%84/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><meta name="yandex-verification" content="{&quot;enable&quot;:true,&quot;main&quot;:&quot;#49B1F5&quot;,&quot;paginator&quot;:&quot;#00c4b6&quot;,&quot;button_hover&quot;:&quot;#FF7242&quot;,&quot;text_selection&quot;:&quot;#00c4b6&quot;,&quot;link_color&quot;:&quot;#99a9bf&quot;,&quot;meta_color&quot;:&quot;#858585&quot;,&quot;hr_color&quot;:&quot;#A4D8FA&quot;,&quot;code_foreground&quot;:&quot;#F47466&quot;,&quot;code_background&quot;:&quot;rgba(27, 31, 35, .05)&quot;,&quot;toc_color&quot;:&quot;#00c4b6&quot;,&quot;blockquote_padding_color&quot;:&quot;#49b1f5&quot;,&quot;blockquote_background_color&quot;:&quot;#49b1f5&quot;}"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: undefined,
  noticeOutdate: {"limitDay":365,"position":"top","messagePrev":"It has been","messageNext":"days since the last update, the content of the article may be outdated."},
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: {"limitCount":500,"languages":{"author":"作者: xiaofan","link":"链接: ","source":"来源: 灰灰爱吃小云朵","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。"}},
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"你已切换为繁体","cht_to_chs":"你已切换为简体","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#ffc0cb","bgDark":"#121212","position":"bottom-left"},
  source: {
    jQuery: 'https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js',
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
    },
    fancybox: {
      js: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js',
      css: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: true,
  isanchor: true
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = { 
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2021-10-23 14:39:16'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          const isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
          const isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
          const isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
          const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

          if (t === undefined) {
            if (isLightMode) activateLightMode()
            else if (isDarkMode) activateDarkMode()
            else if (isNotSpecified || hasNoSupport) {
              const now = new Date()
              const hour = now.getHours()
              const isNight = hour <= 6 || hour >= 18
              isNight ? activateDarkMode() : activateLightMode()
            }
            window.matchMedia('(prefers-color-scheme: dark)').addListener(function (e) {
              if (saveToLocal.get('theme') === undefined) {
                e.matches ? activateDarkMode() : activateLightMode()
              }
            })
          } else if (t === 'light') activateLightMode()
          else activateDarkMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const fontSizeVal = saveToLocal.get('global-font-size')
    if (fontSizeVal !== undefined) {
      document.documentElement.style.setProperty('--global-font-size', fontSizeVal + 'px')
    }
    })(window)</script><link rel="stylesheet" href="/css/mycss/background.css"><link rel="stylesheet" href="/css/mycss/footer.css"><link rel="stylesheet" href="/css/mycss/scroll_bar.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/sviptzk/HexoStaticFile@latest/Hexo/css/hideCategory.min.css"><link rel="stylesheet" href="/css/mycss/read.css"><link rel="stylesheet" href="https://unpkg.com/swiper/swiper-bundle.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Zfour/Butterfly-card-history/baiduhistory/css/main.css"><!-- hexo injector head_end start --><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Zfour/Butterfly-double-row-display@1.00/cardlistpost.min.css"/>
<style>#recent-posts > .recent-post-item >.recent-post-info > .article-meta-wrap > .tags:before {content:"\A";
  white-space: pre;}#recent-posts > .recent-post-item >.recent-post-info > .article-meta-wrap > .tags > .article-meta__separator{display:none}</style>
<!-- hexo injector head_end end --><meta name="generator" content="Hexo 5.3.0"></head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="spinner-box"><div class="configure-border-1"><div class="configure-core"></div></div><div class="configure-border-2"><div class="configure-core"></div></div><div class="loading-word">加载中...</div></div></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="author-avatar"><img class="avatar-img" data-lazy-src="/img/%E5%A4%B4%E5%83%8F.gif" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data"><div class="data-item is-center"><div class="data-item-link"><a href="/archives/"><div class="headline">文章</div><div class="length-num">35</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/tags/"><div class="headline">标签</div><div class="length-num">29</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/categories/"><div class="headline">分类</div><div class="length-num">17</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">灰灰爱吃小云朵</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">网络是怎样连接的<a class="post-edit-link" href="https://github.com/755400668/755400668.github.io/_posts/网络是怎样连接的.md" title="编辑" target="_blank"><i class="fas fa-pencil-alt"></i></a></h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2021-09-27T02:32:33.000Z" title="发表于 2021-09-27 10:32:33">2021-09-27</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2021-10-23T06:39:16.095Z" title="更新于 2021-10-23 14:39:16">2021-10-23</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/">计算机网络</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">4.7k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>14分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><hr>
<blockquote>
<p>从在浏览器中输入网址，到屏幕上显示出网页的内容，在这个只有几秒钟的过程中，很多硬件和软件都在各自的岗位上相互配合完成了一系列的工作。本书将以探索之旅的形式，带领大家探索这一系列工作中的每一个环节。每个单独的环节都并不复杂，只要仔细阅读就一定能够理解。不过，探索之旅中出现的硬件和软件数量庞大，如果仅从微观的视角关注每一个单独的点，可能就会因为看不到整体而迷失了方向。因此，在真正出发开始探索之前，我们先来对这次探索之旅作个简单的介绍。下面的介绍中还包含一张探索之旅的路线图，万一在旅途中迷失了方向，请大家务必回来看一看这张地图</p>
</blockquote>
<p><img src= "/img/loading2.gif" data-lazy-src="https://gitee.com/minghuifan/image/raw/master/20210927085209.png" alt="image-20210927085202434"></p>
<blockquote>
<p>大纲，章节目录</p>
</blockquote>
<ol>
<li>Web 浏览器</li>
<li>协议栈、网卡</li>
<li>集线器、交换机、路由器</li>
<li>接入网、网络运营商</li>
<li>防火墙、缓存服务器</li>
<li>Web 服务器</li>
</ol>
<blockquote>
<p>本书关键字，按照章节</p>
</blockquote>
<ol>
<li><p>浏览器生成消息</p>
<p>浏览器、Web 服务器、网址（URL）、HTTP、HTML、协议、URI、请求消息、解析器、Socket 库、DNS 服务器、域名</p>
</li>
<li><p>用电信号传输 TCP/IP 数据</p>
</li>
<li></li>
</ol>
<hr>
<h1 id="第一章-浏览器生成消息"><a href="#第一章-浏览器生成消息" class="headerlink" title="第一章 浏览器生成消息"></a>第一章 浏览器生成消息</h1><blockquote>
<p>qu：浏览器等网络应用程序实际上并不具备网络控制功能</p>
</blockquote>
<p>应用程序并不是自己控制网络，而是委托操作系统（协议栈）来控制网络</p>
<h2 id="1-1-生成-HTTP-请求消息"><a href="#1-1-生成-HTTP-请求消息" class="headerlink" title="1.1 生成 HTTP 请求消息"></a>1.1 生成 HTTP 请求消息</h2><h3 id="1-1-1-输入网址开始"><a href="#1-1-1-输入网址开始" class="headerlink" title="1.1.1 输入网址开始"></a>1.1.1 输入网址开始</h3><p>URL 会以 <code>http:、ftp:、file:、mailto:</code> 等作为开头，简单理解为这些开头是给浏览器一个访问方法，告诉浏览器访问的是什么服务器。比如 ”http:“ 访问 Web 服务器、”ftp:“ 访问 FTP 服务器。我们把这些开头文字理解为协议类型（HTTP 协议、FTP 协议等）</p>
<p>通常 URL 会包含<code>服务器的域名和要访问的文件的路径名</code>而发邮件的 URL 则包含收件人的邮件地址，此外，根据需要，URL 中还会包含用户名、密码、服务器端口号等信息。</p>
<p><img src= "/img/loading2.gif" data-lazy-src="https://gitee.com/minghuifan/image/raw/master/20210927092730.png" alt="image-20210927092730697"></p>
<h3 id="1-1-2-浏览器解析-URL"><a href="#1-1-2-浏览器解析-URL" class="headerlink" title="1.1.2 浏览器解析 URL"></a>1.1.2 浏览器解析 URL</h3><p><img src= "/img/loading2.gif" data-lazy-src="https://gitee.com/minghuifan/image/raw/master/20210927093039.png" alt="image-20210927093039572"></p>
<p><img src= "/img/loading2.gif" data-lazy-src="https://gitee.com/minghuifan/image/raw/master/20210927093117.png" alt="image-20210927093117912"></p>
<h3 id="1-1-3-省略文件名情况"><a href="#1-1-3-省略文件名情况" class="headerlink" title="1.1.3 省略文件名情况"></a>1.1.3 省略文件名情况</h3><blockquote>
<p>浏览器的第一步工作就是对 URL 进行解析</p>
</blockquote>
<ol>
<li><p><a target="_blank" rel="noopener" href="http://www.lab.glasscom.com/dir/">http://www.lab.glasscom.com/dir/</a></p>
<p>很清楚，访问 dir 目录下设置的默认文件，大多数情况是 index.html、default.htm</p>
</li>
<li><p><a target="_blank" rel="noopener" href="http://www.lab.glasscom.com/">http://www.lab.glasscom.com/</a></p>
<p>访问 / 目录下的默认文件</p>
</li>
<li><p><a target="_blank" rel="noopener" href="http://www.lab.glasscom.com/">http://www.lab.glasscom.com</a></p>
<p>没有写目录，代表访问根目录下事先设置的默认文件</p>
</li>
<li><p><a target="_blank" rel="noopener" href="http://www.lab.glasscom.com/whatisthis">http://www.lab.glasscom.com/whatisthis</a></p>
<p>whatisthis 后面没有 <code>/</code>很容易理解为是一个文件，其实实际上很多人会把目录后面的<code>/</code>省略不写。所以这种情况下，如果 Web 服务器上存在名为 whatisthis 的文件，就当做文件名处理，如果存在名为 whatisthis 的目录，就当做目录名来处理</p>
<blockquote>
<p>我们无法创建两个名字相同的文件和目录，因此不可能既有一个名为 whatisthis 的文件，同时又有一个名为whatisthis 的目录。只要查询一下磁盘中的文件和目录，就可以知道whatisthis 究竟是一个文件还是一个目录了，并不会产生歧义。</p>
</blockquote>
</li>
</ol>
<h3 id="1-1-4-HTTP-基本思路"><a href="#1-1-4-HTTP-基本思路" class="headerlink" title="1.1.4 HTTP 基本思路"></a>1.1.4 HTTP 基本思路</h3><p>解析完 URL 之后，我们就知道应该要访问的目标在哪里了。接下来，浏览器会使用 HTTP 协议来访问 Web 服务器。</p>
<p>HTTP 协议定义了客户端和服务器之间交互的消息内容和步骤，其基本思路非常简单。</p>
<p>首先，客户端会向服务器发送请求消息（图1.4）。请求消息中包含的内容是“对什么”和“进行怎样的操作”两个部分。其中相当于“对什么”的部分称为 URI。一般来说，URI 的内容是一个存放网页数据的文件名或者是一个 CGI 程序的文件名，例如“/dir1/file1.html” “/dir1/program1.cgi”等。不过，URI 不仅限于此，也可以直接使用“http:”开头的 URL 来作为URI。换句话说就是，这里可以写各种访问目标，而这些访问目标统称为 URI。相当于接下来“进行怎样的操作”的部分称为方法。方法表示需要让 Web 服务器完成怎样的工作，其中典型的例子包括读取 URI 表示的数据、将客户端输入的数据发送给 URI 表示的程序等。</p>
<p><img src= "/img/loading2.gif" data-lazy-src="https://gitee.com/minghuifan/image/raw/master/20210927094234.png" alt="image-20210927094234455"></p>
<p>响应消息的<code>状态码</code>（<a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/HTTP%E7%8A%B6%E6%80%81%E7%A0%81">详情</a>）表示操作的执行结果是成功还是错误，比如找不到文件就显示 404 Not Found 的错误信息</p>
<p><img src= "/img/loading2.gif" data-lazy-src="https://gitee.com/minghuifan/image/raw/master/20210927095645.png" alt="image-20210927095645155"></p>
<p><img src= "/img/loading2.gif" data-lazy-src="https://gitee.com/minghuifan/image/raw/master/20210927094951.png" alt="image-20210927094951494"></p>
<blockquote>
<p>GET 方法能够发送的数据只有几百个字节，如果表单中的数据超过这一长度，则必须使用POST 方法来发</p>
</blockquote>
<h3 id="1-1-5-生成-HTTP-请求消息"><a href="#1-1-5-生成-HTTP-请求消息" class="headerlink" title="1.1.5 生成 HTTP 请求消息"></a>1.1.5 生成 HTTP 请求消息</h3><p>请求消息是从在浏览器顶部的地址栏中输入网址开始的，但浏览器并非只有在这一种场景下才会向Web 服务器发送请求消息。比如点击网页中的超级链接，或者在表单中填写信息后点击“提交”按钮，这些场景都会触发浏览器的工作，而选用哪种方法也是根据场景来确定的。</p>
<p><img src= "/img/loading2.gif" data-lazy-src="https://gitee.com/minghuifan/image/raw/master/20210927101534.png" alt="image-20210927101534804"></p>
<ol>
<li>第一行：末尾要写上 HTTP 的版本号，为了表示该消息是基于哪个版本的 HTTP 规格编写的</li>
<li>第二行：称为 <a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/HTTP%E5%A4%B4%E5%AD%97%E6%AE%B5">消息头</a>，保存一些额外的详细信息。消息头的规格中定义了很多项目，如日期、客户端支持的数据类型、语言、压缩格式、客户端和服务器的软件名称和版本、数据有效期和最后更新时间等</li>
<li>写完消息头之后，还需要添加一个完全没有内容的空行，然后写上需要发送的数据。这一部分称为消息体，也就是消息的主体。不过，在使用 GET 方法的情况下，仅凭方法和 URI，Web 服务器就能够判断需要进行怎样的操作，因此消息体中不需要填写任何数据。消息体结束之后，整个消息也就结束了</li>
</ol>
<blockquote>
<p>表单请求消息在 HTML 中的代码</p>
</blockquote>
<p><img src= "/img/loading2.gif" data-lazy-src="https://gitee.com/minghuifan/image/raw/master/20210927102106.png" alt="image-20210927102106088"></p>
<h3 id="1-1-6-发送请求后会收到响应"><a href="#1-1-6-发送请求后会收到响应" class="headerlink" title="1.1.6 发送请求后会收到响应"></a>1.1.6 发送请求后会收到响应</h3><p>响应消息的格式以及基本思路和请求消息是相同的（图1.5（b）），差别只在第一行上。在响应消息中，第一行的内容为<code>状态码</code>和<code>响应短语</code>，用来表示请求的执行结果是成功还是出错。状态码和响应短语表示的内容一致，但它们的用途不同。状态码是一个数字，它主要用来向程序告知执行的结果（表1.3）；相对地，响应短语则是一段文字，用来向人们告知执行的结果。</p>
<p>返回响应消息之后，浏览器会将数据提取出来展现在屏幕上，如果这个网页之后文字就结束了，如果里面还有图片资源，浏览器就还要给 Web 服务器发送请求消息。由于每条请求消息只能写一个 URI，即每次只能能获取一个文件，所以有多少张图片就要发送多少个请求消息。</p>
<p>判断所需的文件，然后获取这些文件并显示在屏幕上，这一系列工作的整体指挥也是浏览器的任务之一，而 Web 服务器却毫不知情。Web 服务器完全不关心这 4 条请求获取的文件到底是 1 个网页上的还是不同网页上的，它的任务就是对每一条单独的请求返回 1 条响应而已。</p>
<blockquote>
<p>1 条请求消息中只能写1 个URI。如果需要获取多个文件，必须对每个文件单独发送1 条请求。</p>
</blockquote>
<blockquote>
<p>示例：我们需要获取一张名为 sample1.htm 的网页，网页中包含一张名为 picture.jpg 的图片</p>
</blockquote>
<p><img src= "/img/loading2.gif" data-lazy-src="https://gitee.com/minghuifan/image/raw/master/20210927122123.png" alt="Snipaste_2021-09-27_12-14-52"></p>
<h2 id="1-2-向-DNS-服务器查询-Web-服务器的-IP-地址"><a href="#1-2-向-DNS-服务器查询-Web-服务器的-IP-地址" class="headerlink" title="1.2 向 DNS 服务器查询 Web 服务器的 IP 地址"></a>1.2 向 DNS 服务器查询 Web 服务器的 IP 地址</h2><h3 id="1-2-1-IP-地址的基本知识"><a href="#1-2-1-IP-地址的基本知识" class="headerlink" title="1.2.1 IP 地址的基本知识"></a>1.2.1 IP 地址的基本知识</h3><p>生成了 HTTP 消息之后，我们就要委托操作系统的协议栈将消息发送给 Web 服务器，虽然浏览器能够解析网址生成 HTTP 消息，但是不具备将消息发送到网络的功能</p>
<p>但是在此之前我们还需要一个工作，就是将服务器的域名转化为 IP 地址，这样才能访问到域名所指向的服务器。</p>
<blockquote>
<p>IP 的表示方法</p>
</blockquote>
<p>32 位二进制数，每 8 个为一组（即化为十进制最大为 2^8^ - 1 = 255），习惯上转化为十进制数</p>
<p><code>/</code>后面为子网掩码，与 IP 地址一样是 32 位二进制数，子网掩码为 1 的部分表示网络号，子网掩码为 0 的部分表示主机号。将子网掩码按照和 IP 地址一样的方式以每 8 比特为单位用圆点分组后写在 IP 地址的右侧。</p>
<p>子网掩码的两种写法：</p>
<ol>
<li>10.11.12.13/255.255.255.0</li>
<li>10.11.12.13/24</li>
</ol>
<p>后者 24 即表示从左边数有多少个 1，3 组 8 位即有 24 个 1</p>
<p><img src= "/img/loading2.gif" data-lazy-src="https://gitee.com/minghuifan/image/raw/master/20210927134157.png" alt="image-20210927134157904"></p>
<p><img src= "/img/loading2.gif" data-lazy-src="https://gitee.com/minghuifan/image/raw/master/20211003090232.png" alt="image-20211003090232749"></p>
<p>顺带一提，主机号部分的比特全部为 0 或者全部为 1 时代表两种特殊的含义</p>
<p>IP 地址的主机号</p>
<ul>
<li>全 0：表示整个子网</li>
<li>全 1：表示向子网上所有设备发送包，即“广播”</li>
</ul>
<h3 id="1-2-2-IP-和-子网掩码并用理由"><a href="#1-2-2-IP-和-子网掩码并用理由" class="headerlink" title="1.2.2 IP 和 子网掩码并用理由"></a>1.2.2 IP 和 子网掩码并用理由</h3><h3 id="1-2-3-Socket-库提供查询-IP-地址的功能"><a href="#1-2-3-Socket-库提供查询-IP-地址的功能" class="headerlink" title="1.2.3 Socket 库提供查询 IP 地址的功能"></a>1.2.3 Socket 库提供查询 IP 地址的功能</h3><blockquote>
<p>Socket 库是用于调用网络功能的程序组件集合</p>
</blockquote>
<blockquote>
<p>DNS：Domain Name System，域名服务系统。将服务器名称和 IP 地址进行关联是 DNS 最常见的用法</p>
<p>通过 DNS 查询 IP 地址的操作称为域名解析，因此负责执行解析（resolution）这一操作的就叫解析器（resolver）了</p>
<p>解析器实际上是一段程序，它包含在操作系统的 Socket 库中，Socket 库中包含很多用于发送和接收数据的程序组件</p>
</blockquote>
<p>我们电脑本地具有 DNS 客户端（DNS 解析器），可以进行更改，<a target="_blank" rel="noopener" href="https://cloud.tencent.com/developer/article/1352604">全国DNS服务器IP大全</a></p>
<p><img src= "/img/loading2.gif" data-lazy-src="https://gitee.com/minghuifan/image/raw/master/20211003091159.png" alt="image-20211003091159096"></p>
<h3 id="1-2-4-通过解析器向-DNS-服务器发出查询"><a href="#1-2-4-通过解析器向-DNS-服务器发出查询" class="headerlink" title="1.2.4　通过解析器向 DNS 服务器发出查询"></a>1.2.4　通过解析器向 DNS 服务器发出查询</h3><p>在编写浏览器等应用程序的时候，只要像图1.11 这样写上解析器的程序名称“gethostbyname”以及Web 服务器的域名“<a target="_blank" rel="noopener" href="http://www.lab.glasscom.com”就可以了,这样就完成了对解析器的调用/">www.lab.glasscom.com”就可以了，这样就完成了对解析器的调用</a></p>
<p>浏览器在向 Web 服务器发送消息时，只要从该内存地址取出 IP 地址，并将它与 HTTP 请求消息一起交给操作系统就可以了</p>
<p><img src= "/img/loading2.gif" data-lazy-src="https://gitee.com/minghuifan/image/raw/master/20211003092104.png" alt="image-20211003092104311"></p>
<blockquote>
<p>根据域名查询IP 地址时，浏览器会使用Socket 库中的解析器。</p>
</blockquote>
<h3 id="1-2-5-解析器的内部原理"><a href="#1-2-5-解析器的内部原理" class="headerlink" title="1.2.5　解析器的内部原理"></a>1.2.5　解析器的内部原理</h3><p><img src= "/img/loading2.gif" data-lazy-src="https://gitee.com/minghuifan/image/raw/master/20211003095002.png" alt="image-20211003095002008"></p>
<h2 id="1-3-全世界-DNS-服务器的大接力"><a href="#1-3-全世界-DNS-服务器的大接力" class="headerlink" title="1.3 全世界 DNS 服务器的大接力"></a>1.3 全世界 DNS 服务器的大接力</h2><h3 id="1-3-1-DNS-服务器的基本工作"><a href="#1-3-1-DNS-服务器的基本工作" class="headerlink" title="1.3.1 DNS 服务器的基本工作"></a>1.3.1 DNS 服务器的基本工作</h3><p>客户端的查询方式包括 3 种信息</p>
<ol>
<li>域名：服务器、邮件服务器（邮件地址中@ 后面的部分）的名称</li>
<li>Class：在最早设计DNS 方案时，DNS 在互联网以外的其他网络中的应用也被考虑到了，而Class 就是用来识别网络的信息。不过，如今除了互联网并没有其他的网络了，因此Class 的值永远是代表互联网的IN</li>
<li>记录类型：表示域名对应何种类型的记录。例如，当类型为A 时，表示域名对应的是IP 地址；当类型为MX 时，表示域名对应的是邮件服务器。对于不同的记录类型，服务器向客户端返回的信息也会不同</li>
</ol>
<p>DNS 服务器上事先保存有前面这3 种信息对应的记录数据，如图1.14所示。DNS 服务器就是根据这些记录查找符合查询请求的内容并对客户端作出响应的</p>
<p><img src= "/img/loading2.gif" data-lazy-src="https://gitee.com/minghuifan/image/raw/master/20211003095544.png" alt="image-20211003095544054"></p>
<blockquote>
<p>例如，如果要查询<a target="_blank" rel="noopener" href="http://www.lab.glasscom.com/">www.lab.glasscom.com</a> 这个域名对应的IP 地址，客户端会向 DNS 服务器发送包含以下信息的查询消息。<br>（a） 域名 = <a target="_blank" rel="noopener" href="http://www.lab.glasscom.com/">www.lab.glasscom.com</a><br>（b） Class = IN<br>（c） 记录类型 = A</p>
</blockquote>
<blockquote>
<p>DNS 服务器会从域名与IP 地址的对照表中查找相应的记录，并返回IP 地址。</p>
</blockquote>
<h3 id="1-3-2-域名的层次结构"><a href="#1-3-2-域名的层次结构" class="headerlink" title="1.3.2　域名的层次结构"></a>1.3.2　域名的层次结构</h3><p>我们知道 IP 是一串以点分隔的字符串，以点分隔成多个部分，每个部分对应该层次的 DNS 服务器</p>
<p>比如，全国是一个最大的域，中国是全国域中的一个子集，中国的省份是中国域中的一个子集，就这样层层分隔下去</p>
<blockquote>
<p>实际上，由于一台DNS 服务器可以存放多个域的信息，因此并不是每个域名都有一台与之相对应的DNS 服务器。比如网络运营商的DNS 服务器中就存放了很多个域的信息</p>
</blockquote>
<h3 id="1-3-3-寻找相应的-DNS-服务器并获取-IP-地址"><a href="#1-3-3-寻找相应的-DNS-服务器并获取-IP-地址" class="headerlink" title="1.3.3　寻找相应的 DNS 服务器并获取 IP 地址"></a>1.3.3　寻找相应的 DNS 服务器并获取 IP 地址</h3><p>根域几乎每个 DNS 服务器都保存有，只要访问任何一个 DNS 服务器都可以找到根域，来到根域然后一路找下去就可以找到需要查找的服务器 IP 了</p>
<blockquote>
<p>分配给根域DNS 服务器的 IP 地址在全世界仅有 13 个，而且这些地址几乎不发生变化，因此将这些地址保存在所有的DNS 服务器中也并不是一件难事</p>
<p>根域 DNS 服务器在运营上使用多台服务器来对应一个 IP 地址，因此尽管 IP 地址只有13 个，但其实服务器的数量是很多的</p>
</blockquote>
<p>下图客户端先访问最近的一台 DNS 服务器（也就是客户端的 TCP/IP 设置中填写的DNS 服务器地址）</p>
<p><img src= "/img/loading2.gif" data-lazy-src="https://gitee.com/minghuifan/image/raw/master/20211003100951.png" alt="image-20211003100951709"></p>
<p><img src= "/img/loading2.gif" data-lazy-src="https://gitee.com/minghuifan/image/raw/master/20211003101439.png" alt="image-20211003101439097"></p>
<h3 id="1-3-4-通过缓存加快DNS-服务器的响应"><a href="#1-3-4-通过缓存加快DNS-服务器的响应" class="headerlink" title="1.3.4　通过缓存加快DNS 服务器的响应"></a>1.3.4　通过缓存加快DNS 服务器的响应</h3><p>通过上面的内容，并不是每个 DNS 服务器都只管理一个域，现实中上级域和下级域可能共享在一台 DNS 服务器中</p>
<p>此外，有时候并不需要从最上级的根域开始查找，因为 DNS 服务器有一个缓存功能，可以记住之前查询过的域名。如果要查询的域名和相关信息已经在缓存中，那么就可以直接返回响应，接下来的查询可以从缓存的位置开始向下进行。相比每次都从根域找起来说，缓存可以减少查询所需的时间</p>
<blockquote>
<p>这个缓存机制中有一点需要注意，那就是信息被缓存后，原本的注册信息可能会发生改变，这时缓存中的信息就有可能是不正确的。因此，DNS 服务器中保存的信息都设置有一个有效期，当缓存中的信息超过有效期后，数据就会从缓存中删除。而且，在对查询进行响应时，DNS 服务器也会告知客户端这一响应的结果是来自缓存中还是来自负责管理该域名的 DNS 服务器</p>
</blockquote>
<h2 id="1-4-委托协议栈发送消息"><a href="#1-4-委托协议栈发送消息" class="headerlink" title="1.4 委托协议栈发送消息"></a>1.4 委托协议栈发送消息</h2><h3 id="1-4-1-数据收发操作概览"><a href="#1-4-1-数据收发操作概览" class="headerlink" title="1.4.1　数据收发操作概览"></a>1.4.1　数据收发操作概览</h3><p>知道目标服务器的 IP 地址之后，浏览器就可以委托操作系统内部的协议栈向该 IP 地址的服务器发送 HTTP 请求消息了</p>
<p>HTTP 消息是一种数字信息（digital data），因此可以说是委托协议栈发送数字信息。收发数字信息的这一操作并不局限于浏览器，对于使用网络的应用程序都是共通的</p>
<p>和向DNS 服务器查询 IP 地址的操作一样，这里也需要使用 Socket 库中的程序组件。不过，查询 IP 地址只需要调用一个程序组件就可以了，而这里需要按照指定的顺序调用多个程序组件，这个过程有点复杂</p>
<blockquote>
<p>向操作系统内部的协议栈发出委托时，需要按照指定的顺序来调用 Socket 库中的程序组件</p>
</blockquote>
<p>收发数据的操作分为若干个阶段，可以大致总结为以下4 个</p>
<ol>
<li>创建套接字（创建套接字阶段）</li>
<li>将管道连接到服务器端的套接字上（连接阶段）</li>
<li>收发数据（通信阶段）</li>
<li>断开管道并删除套接字（断开阶段）</li>
</ol>
<h3 id="1-4-2-创建套接字阶段"><a href="#1-4-2-创建套接字阶段" class="headerlink" title="1.4.2　创建套接字阶段"></a>1.4.2　创建套接字阶段</h3><ul>
<li><p>① 调用 Socke 库名为的 socket 程序组件就可以创建一个套接字了，套接字创建完成后，协议栈会返回一个描述符，应用程序会将收到的描述符放在内存中</p>
<p>描述符是用来识别不同的套接字的，可以理解为给套接字进行编号</p>
<p>当创建套接字后，我们就可以使用这个套接字来执行收发数据的操作了。这时，只要我们出示描述符，协议栈就能够判断出我们希望用哪一个套接字来连接或者收发数据了</p>
<blockquote>
<p>应用程序是通过“描述符”这一类似号码牌的东西来识别套接字的</p>
</blockquote>
</li>
<li></li>
</ul>
<p><img src= "/img/loading2.gif" data-lazy-src="https://gitee.com/minghuifan/image/raw/master/20211003151308.png" alt="image-20211003151308652"></p>
<h3 id="1-4-3-连接阶段：把管道接上去"><a href="#1-4-3-连接阶段：把管道接上去" class="headerlink" title="1.4.3　连接阶段：把管道接上去"></a>1.4.3　连接阶段：把管道接上去</h3><h3 id="1-4-4-通信阶段：传递消息"><a href="#1-4-4-通信阶段：传递消息" class="headerlink" title="1.4.4　通信阶段：传递消息"></a>1.4.4　通信阶段：传递消息</h3><h3 id="1-4-5-断开阶段：收发数据结束"><a href="#1-4-5-断开阶段：收发数据结束" class="headerlink" title="1.4.5　断开阶段：收发数据结束"></a>1.4.5　断开阶段：收发数据结束</h3><hr>
<h1 id="第2章-用电信号传输TCP-IP-数据"><a href="#第2章-用电信号传输TCP-IP-数据" class="headerlink" title="第2章 用电信号传输TCP/IP 数据"></a>第2章 用电信号传输TCP/IP 数据</h1><h2 id="2-1-创建套接字"><a href="#2-1-创建套接字" class="headerlink" title="2.1 创建套接字"></a>2.1 创建套接字</h2><h3 id="2-1-1-协议栈的内部结构"><a href="#2-1-1-协议栈的内部结构" class="headerlink" title="2.1.1 协议栈的内部结构"></a>2.1.1 协议栈的内部结构</h3><blockquote>
<p>比如我们要在两个端系统上传送数据，应用是在应用层，如何实现两个端系统在应用层进行数据收发，这就要借助传输层提供的服务</p>
<p>我们要传输给对方数据</p>
<p>第一：需要知道对方的 IP 地址以及端口号，常见的 Web 服务器端口号为 80</p>
<p>第二：自身的 IP 以及应用也需要传送给对方</p>
<p>应用层里面有应用，应用跑在某个主机上面，</p>
</blockquote>
<p><img src= "/img/loading2.gif" data-lazy-src="https://gitee.com/minghuifan/image/raw/master/20211003160316.png" alt="image-20211003160316077"></p>
<h3 id="2-1-2-套接字的实体就是通信控制信息"><a href="#2-1-2-套接字的实体就是通信控制信息" class="headerlink" title="2.1.2　套接字的实体就是通信控制信息"></a>2.1.2　套接字的实体就是通信控制信息</h3><h3 id="2-1-3-调用socket-时的操作"><a href="#2-1-3-调用socket-时的操作" class="headerlink" title="2.1.3　调用socket 时的操作"></a>2.1.3　调用socket 时的操作</h3><h2 id="2-2-连接服务器"><a href="#2-2-连接服务器" class="headerlink" title="2.2　连接服务器"></a>2.2　连接服务器</h2><h3 id="2-2-1-连接是什么意思"><a href="#2-2-1-连接是什么意思" class="headerlink" title="2.2.1　连接是什么意思"></a>2.2.1　连接是什么意思</h3><h3 id="2-2-2-负责保存控制信息的头部"><a href="#2-2-2-负责保存控制信息的头部" class="headerlink" title="2.2.2　负责保存控制信息的头部"></a>2.2.2　负责保存控制信息的头部</h3></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">xiaofan</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="http://755400668.github.io/2021/09/27/%E7%BD%91%E7%BB%9C%E6%98%AF%E6%80%8E%E6%A0%B7%E8%BF%9E%E6%8E%A5%E7%9A%84/">http://755400668.github.io/2021/09/27/网络是怎样连接的/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://755400668.github.io" target="_blank">灰灰爱吃小云朵</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E4%B9%A6%E7%B1%8D/">书籍</a></div><div class="post_share"><div class="social-share" data-image="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><div class="post-reward"><div class="reward-button button--animated"><i class="fas fa-qrcode"></i> 打赏</div><div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="/img/wechat.jpg" target="_blank"><img class="post-qr-code-img" data-lazy-src="/img/wechat.jpg" alt="wechat"/></a><div class="post-qr-code-desc">wechat</div></li><li class="reward-item"><a href="/img/alipay.jpg" target="_blank"><img class="post-qr-code-img" data-lazy-src="/img/alipay.jpg" alt="alipay"/></a><div class="post-qr-code-desc">alipay</div></li></ul></div></div><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div class="vcomment" id="vcomment"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="card-info-avatar is-center"><img class="avatar-img" data-lazy-src="/img/%E5%A4%B4%E5%83%8F.gif" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/><div class="author-info__name">xiaofan</div><div class="author-info__description"></div></div><div class="card-info-data"><div class="card-info-data-item is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">35</div></a></div><div class="card-info-data-item is-center"><a href="/tags/"><div class="headline">标签</div><div class="length-num">29</div></a></div><div class="card-info-data-item is-center"><a href="/categories/"><div class="headline">分类</div><div class="length-num">17</div></a></div></div><a class="button--animated" id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/755400668"><i class="fab fa-github"></i><span>Github</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/755400668" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="mailto:755400668@qq.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn card-announcement-animation"></i><span>公告</span></div><div class="announcement_content">欢迎来到灰灰爱吃小云朵的博客,功能还在完善中！</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%AC%AC%E4%B8%80%E7%AB%A0-%E6%B5%8F%E8%A7%88%E5%99%A8%E7%94%9F%E6%88%90%E6%B6%88%E6%81%AF"><span class="toc-number">1.</span> <span class="toc-text">第一章 浏览器生成消息</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-1-%E7%94%9F%E6%88%90-HTTP-%E8%AF%B7%E6%B1%82%E6%B6%88%E6%81%AF"><span class="toc-number">1.1.</span> <span class="toc-text">1.1 生成 HTTP 请求消息</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-1-1-%E8%BE%93%E5%85%A5%E7%BD%91%E5%9D%80%E5%BC%80%E5%A7%8B"><span class="toc-number">1.1.1.</span> <span class="toc-text">1.1.1 输入网址开始</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-1-2-%E6%B5%8F%E8%A7%88%E5%99%A8%E8%A7%A3%E6%9E%90-URL"><span class="toc-number">1.1.2.</span> <span class="toc-text">1.1.2 浏览器解析 URL</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-1-3-%E7%9C%81%E7%95%A5%E6%96%87%E4%BB%B6%E5%90%8D%E6%83%85%E5%86%B5"><span class="toc-number">1.1.3.</span> <span class="toc-text">1.1.3 省略文件名情况</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-1-4-HTTP-%E5%9F%BA%E6%9C%AC%E6%80%9D%E8%B7%AF"><span class="toc-number">1.1.4.</span> <span class="toc-text">1.1.4 HTTP 基本思路</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-1-5-%E7%94%9F%E6%88%90-HTTP-%E8%AF%B7%E6%B1%82%E6%B6%88%E6%81%AF"><span class="toc-number">1.1.5.</span> <span class="toc-text">1.1.5 生成 HTTP 请求消息</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-1-6-%E5%8F%91%E9%80%81%E8%AF%B7%E6%B1%82%E5%90%8E%E4%BC%9A%E6%94%B6%E5%88%B0%E5%93%8D%E5%BA%94"><span class="toc-number">1.1.6.</span> <span class="toc-text">1.1.6 发送请求后会收到响应</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-2-%E5%90%91-DNS-%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%9F%A5%E8%AF%A2-Web-%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%9A%84-IP-%E5%9C%B0%E5%9D%80"><span class="toc-number">1.2.</span> <span class="toc-text">1.2 向 DNS 服务器查询 Web 服务器的 IP 地址</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-2-1-IP-%E5%9C%B0%E5%9D%80%E7%9A%84%E5%9F%BA%E6%9C%AC%E7%9F%A5%E8%AF%86"><span class="toc-number">1.2.1.</span> <span class="toc-text">1.2.1 IP 地址的基本知识</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-2-2-IP-%E5%92%8C-%E5%AD%90%E7%BD%91%E6%8E%A9%E7%A0%81%E5%B9%B6%E7%94%A8%E7%90%86%E7%94%B1"><span class="toc-number">1.2.2.</span> <span class="toc-text">1.2.2 IP 和 子网掩码并用理由</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-2-3-Socket-%E5%BA%93%E6%8F%90%E4%BE%9B%E6%9F%A5%E8%AF%A2-IP-%E5%9C%B0%E5%9D%80%E7%9A%84%E5%8A%9F%E8%83%BD"><span class="toc-number">1.2.3.</span> <span class="toc-text">1.2.3 Socket 库提供查询 IP 地址的功能</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-2-4-%E9%80%9A%E8%BF%87%E8%A7%A3%E6%9E%90%E5%99%A8%E5%90%91-DNS-%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%8F%91%E5%87%BA%E6%9F%A5%E8%AF%A2"><span class="toc-number">1.2.4.</span> <span class="toc-text">1.2.4　通过解析器向 DNS 服务器发出查询</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-2-5-%E8%A7%A3%E6%9E%90%E5%99%A8%E7%9A%84%E5%86%85%E9%83%A8%E5%8E%9F%E7%90%86"><span class="toc-number">1.2.5.</span> <span class="toc-text">1.2.5　解析器的内部原理</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-3-%E5%85%A8%E4%B8%96%E7%95%8C-DNS-%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%9A%84%E5%A4%A7%E6%8E%A5%E5%8A%9B"><span class="toc-number">1.3.</span> <span class="toc-text">1.3 全世界 DNS 服务器的大接力</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-3-1-DNS-%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%9A%84%E5%9F%BA%E6%9C%AC%E5%B7%A5%E4%BD%9C"><span class="toc-number">1.3.1.</span> <span class="toc-text">1.3.1 DNS 服务器的基本工作</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-3-2-%E5%9F%9F%E5%90%8D%E7%9A%84%E5%B1%82%E6%AC%A1%E7%BB%93%E6%9E%84"><span class="toc-number">1.3.2.</span> <span class="toc-text">1.3.2　域名的层次结构</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-3-3-%E5%AF%BB%E6%89%BE%E7%9B%B8%E5%BA%94%E7%9A%84-DNS-%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%B9%B6%E8%8E%B7%E5%8F%96-IP-%E5%9C%B0%E5%9D%80"><span class="toc-number">1.3.3.</span> <span class="toc-text">1.3.3　寻找相应的 DNS 服务器并获取 IP 地址</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-3-4-%E9%80%9A%E8%BF%87%E7%BC%93%E5%AD%98%E5%8A%A0%E5%BF%ABDNS-%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%9A%84%E5%93%8D%E5%BA%94"><span class="toc-number">1.3.4.</span> <span class="toc-text">1.3.4　通过缓存加快DNS 服务器的响应</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-4-%E5%A7%94%E6%89%98%E5%8D%8F%E8%AE%AE%E6%A0%88%E5%8F%91%E9%80%81%E6%B6%88%E6%81%AF"><span class="toc-number">1.4.</span> <span class="toc-text">1.4 委托协议栈发送消息</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-4-1-%E6%95%B0%E6%8D%AE%E6%94%B6%E5%8F%91%E6%93%8D%E4%BD%9C%E6%A6%82%E8%A7%88"><span class="toc-number">1.4.1.</span> <span class="toc-text">1.4.1　数据收发操作概览</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-4-2-%E5%88%9B%E5%BB%BA%E5%A5%97%E6%8E%A5%E5%AD%97%E9%98%B6%E6%AE%B5"><span class="toc-number">1.4.2.</span> <span class="toc-text">1.4.2　创建套接字阶段</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-4-3-%E8%BF%9E%E6%8E%A5%E9%98%B6%E6%AE%B5%EF%BC%9A%E6%8A%8A%E7%AE%A1%E9%81%93%E6%8E%A5%E4%B8%8A%E5%8E%BB"><span class="toc-number">1.4.3.</span> <span class="toc-text">1.4.3　连接阶段：把管道接上去</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-4-4-%E9%80%9A%E4%BF%A1%E9%98%B6%E6%AE%B5%EF%BC%9A%E4%BC%A0%E9%80%92%E6%B6%88%E6%81%AF"><span class="toc-number">1.4.4.</span> <span class="toc-text">1.4.4　通信阶段：传递消息</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-4-5-%E6%96%AD%E5%BC%80%E9%98%B6%E6%AE%B5%EF%BC%9A%E6%94%B6%E5%8F%91%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9D%9F"><span class="toc-number">1.4.5.</span> <span class="toc-text">1.4.5　断开阶段：收发数据结束</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%AC%AC2%E7%AB%A0-%E7%94%A8%E7%94%B5%E4%BF%A1%E5%8F%B7%E4%BC%A0%E8%BE%93TCP-IP-%E6%95%B0%E6%8D%AE"><span class="toc-number">2.</span> <span class="toc-text">第2章 用电信号传输TCP&#x2F;IP 数据</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#2-1-%E5%88%9B%E5%BB%BA%E5%A5%97%E6%8E%A5%E5%AD%97"><span class="toc-number">2.1.</span> <span class="toc-text">2.1 创建套接字</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-1-1-%E5%8D%8F%E8%AE%AE%E6%A0%88%E7%9A%84%E5%86%85%E9%83%A8%E7%BB%93%E6%9E%84"><span class="toc-number">2.1.1.</span> <span class="toc-text">2.1.1 协议栈的内部结构</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-1-2-%E5%A5%97%E6%8E%A5%E5%AD%97%E7%9A%84%E5%AE%9E%E4%BD%93%E5%B0%B1%E6%98%AF%E9%80%9A%E4%BF%A1%E6%8E%A7%E5%88%B6%E4%BF%A1%E6%81%AF"><span class="toc-number">2.1.2.</span> <span class="toc-text">2.1.2　套接字的实体就是通信控制信息</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-1-3-%E8%B0%83%E7%94%A8socket-%E6%97%B6%E7%9A%84%E6%93%8D%E4%BD%9C"><span class="toc-number">2.1.3.</span> <span class="toc-text">2.1.3　调用socket 时的操作</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-2-%E8%BF%9E%E6%8E%A5%E6%9C%8D%E5%8A%A1%E5%99%A8"><span class="toc-number">2.2.</span> <span class="toc-text">2.2　连接服务器</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-2-1-%E8%BF%9E%E6%8E%A5%E6%98%AF%E4%BB%80%E4%B9%88%E6%84%8F%E6%80%9D"><span class="toc-number">2.2.1.</span> <span class="toc-text">2.2.1　连接是什么意思</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-2-2-%E8%B4%9F%E8%B4%A3%E4%BF%9D%E5%AD%98%E6%8E%A7%E5%88%B6%E4%BF%A1%E6%81%AF%E7%9A%84%E5%A4%B4%E9%83%A8"><span class="toc-number">2.2.2.</span> <span class="toc-text">2.2.2　负责保存控制信息的头部</span></a></li></ol></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2021/10/22/vlan%E9%85%8D%E7%BD%AE/" title="vlan 配置以及 vlan 间通信">vlan 配置以及 vlan 间通信</a><time datetime="2021-10-22T04:32:33.000Z" title="发表于 2021-10-22 12:32:33">2021-10-22</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2021/10/10/Wallpaper%20Engine%20%E5%A3%81%E7%BA%B8%E6%8F%90%E5%8F%96/" title="Wallpaper Engine 壁纸提取">Wallpaper Engine 壁纸提取</a><time datetime="2021-10-10T02:32:33.000Z" title="发表于 2021-10-10 10:32:33">2021-10-10</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2021/09/27/%E9%80%9A%E4%BF%A1%E5%9F%BA%E7%A1%80/" title="通信技术[基础]">通信技术[基础]</a><time datetime="2021-09-27T02:32:33.000Z" title="发表于 2021-09-27 10:32:33">2021-09-27</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2021/09/27/%E7%BD%91%E7%BB%9C%E6%98%AF%E6%80%8E%E6%A0%B7%E8%BF%9E%E6%8E%A5%E7%9A%84/" title="网络是怎样连接的">网络是怎样连接的</a><time datetime="2021-09-27T02:32:33.000Z" title="发表于 2021-09-27 10:32:33">2021-09-27</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2021/09/07/%E7%BC%96%E8%AF%91%E5%8E%9F%E7%90%86/" title="编译原理">编译原理</a><time datetime="2021-09-07T02:32:33.000Z" title="发表于 2021-09-07 10:32:33">2021-09-07</time></div></div></div></div></div></div></main><footer id="footer" style="background: flse"><div id="footer-wrap"><div class="copyright">&copy;2021  <i id="heartbeat" class="fa fas fa-heartbeat"></i> xiaofan</div><div class="footer_custom_text"><a target="_blank" rel="noopener" href="https://beian.miit.gov.cn"><span>湘ICP备2021007749号</span></a><div id="running-time"></div><script>setInterval(()=>{let create_time=Math.round(new Date(Date.UTC(2021,01,18,0,0,0)).getTime()/1000);let timestamp=Math.round((new Date().getTime()+8*60*60*1000)/1000);let second=timestamp-create_time;let time=new Array(0,0,0,0,0);if(second>=365*24*3600){time[0]=parseInt(second/(365*24*3600));second%=365*24*3600;}if(second>=24*3600){time[1]=parseInt(second/(24*3600));second%=24*3600;}if(second>=3600){time[2]=parseInt(second/3600);second%=3600;}if(second>=60){time[3]=parseInt(second/60);second%=60;}if(second>0){time[4]=second;}currentTimeHtml='本站已安全运行 '+time[0]+' 年 '+time[1]+' 天 '+time[2]+' 时 '+time[3]+' 分 '+time[4]+' 秒';document.getElementById("running-time").innerHTML=currentTimeHtml;},1000);
</script></div></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/HCLonely/images@master/others/heartbeat.min.css"></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="font-plus" type="button" title="放大字体"><i class="fas fa-plus"></i></button><button id="font-minus" type="button" title="缩小字体"><i class="fas fa-minus"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><div class="search-dialog__title" id="local-search-title">本地搜索</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div></div><hr/><div id="local-search-results"></div><span class="search-close-button"><i class="fas fa-times"></i></span></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload/dist/lazyload.iife.min.js"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.js"></script><script>function panguFn () {
  if (typeof pangu === 'object') pangu.autoSpacingPage()
  else {
    getScript('https://cdn.jsdelivr.net/npm/pangu/dist/browser/pangu.min.js')
      .then(() => {
        pangu.autoSpacingPage()
      })
  }
}

function panguInit () {
  if (false){
    GLOBAL_CONFIG_SITE.isPost && panguFn()
  } else {
    panguFn()
  }
}

document.addEventListener('DOMContentLoaded', panguInit)</script><script src="/js/search/local-search.js"></script><script>var preloader = {
  endLoading: () => {
    document.body.style.overflow = 'auto';
    document.getElementById('loading-box').classList.add("loaded")
  },
  initLoading: () => {
    document.body.style.overflow = '';
    document.getElementById('loading-box').classList.remove("loaded")

  }
}
window.addEventListener('load',preloader.endLoading())</script><div class="js-pjax"><script>if (!window.MathJax) {
  window.MathJax = {
    loader: {
      source: {
        '[tex]/amsCd': '[tex]/amscd'
      }
    },
    tex: {
      inlineMath: [ ['$','$'], ["\\(","\\)"]],
      tags: 'ams'
    },
    options: {
      renderActions: {
        findScript: [10, doc => {
          for (const node of document.querySelectorAll('script[type^="math/tex"]')) {
            const display = !!node.type.match(/; *mode=display/)
            const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display)
            const text = document.createTextNode('')
            node.parentNode.replaceChild(text, node)
            math.start = {node: text, delim: '', n: 0}
            math.end = {node: text, delim: '', n: 0}
            doc.math.push(math)
          }
        }, ''],
        addClass: [200,() => {
          document.querySelectorAll('mjx-container:not([display=\'true\']').forEach( node => {
            const target = node.parentNode
            if (!target.classList.contains('has-jax')) {
              target.classList.add('mathjax-overflow')
            }
          })
        }, '', false]
      }
    }
  }
  
  const script = document.createElement('script')
  script.src = 'https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js'
  script.id = 'MathJax-script'
  script.async = true
  document.head.appendChild(script)
} else {
  MathJax.startup.document.state(0)
  MathJax.texReset()
  MathJax.typeset()
}</script><script>if (document.getElementsByClassName('mermaid').length) {
  if (window.mermaidJsLoad) mermaid.init()
  else {
    getScript('https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js').then(() => {
      window.mermaidJsLoad = true
      mermaid.initialize({
        theme: 'dark',
      })
      true && mermaid.init()
    })
  }
}</script><script>function loadValine () {
  function initValine () {
    let initData = {
      el: '#vcomment',
      appId: 'xS20Cql4UsmdctL0h7VKtAKM-MdYXbMMI',
      appKey: 'b5NzzpLCJEwqfX229hVr6TSS',
      placeholder: 'Please leave your footprints',
      avatar: 'monsterid',
      meta: 'nick,mail'.split(','),
      pageSize: '10',
      lang: 'zh-CN',
      recordIP: false,
      serverURLs: '',
      emojiCDN: '',
      emojiMaps: "",
      enableQQ: true,
      path: window.location.pathname,
      visitor: false
    }

    if (true) { 
      initData.requiredFields= ('nick,mail'.split(','))
    }
    
    if (false) {
      const otherData = false
      initData = Object.assign(initData, otherData)
    }
    
    const valine = new Valine(initData)
  }

  if (typeof Valine === 'function') initValine() 
  else getScript('https://cdn.jsdelivr.net/npm/valine/dist/Valine.min.js').then(initValine)
}

if ('Valine' === 'Valine' || !true) {
  if (true) btf.loadComment(document.getElementById('vcomment'),loadValine)
  else setTimeout(loadValine, 0)
} else {
  function loadOtherComment () {
    loadValine()
  }
}</script></div><script defer="defer" id="fluttering_ribbon" mobile="true" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/canvas-fluttering-ribbon.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = true;
POWERMODE.mobile = true;
document.body.addEventListener('input', POWERMODE);
</script><script id="click-heart" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/click-heart.min.js" async="async" mobile="true"></script><script src="https://cdn.jsdelivr.net/npm/pjax/pjax.min.js"></script><script>let pjaxSelectors = [
  'title',
  '#config-diff',
  '#body-wrap',
  '#rightside-config-hide',
  '#rightside-config-show',
  '.js-pjax'
]

if (false) {
  pjaxSelectors.unshift('meta[property="og:image"]', 'meta[property="og:title"]', 'meta[property="og:url"]')
}

var pjax = new Pjax({
  elements: 'a:not([target="_blank"])',
  selectors: pjaxSelectors,
  cacheBust: false,
  analytics: false,
  scrollRestoration: false
})

document.addEventListener('pjax:complete', function () {
  window.refreshFn()

  document.querySelectorAll('script[data-pjax]').forEach(item => {
    const newScript = document.createElement('script')
    const content = item.text || item.textContent || item.innerHTML || ""
    Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
    newScript.appendChild(document.createTextNode(content))
    item.parentNode.replaceChild(newScript, item)
  })

  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()

  typeof chatBtnFn === 'function' && chatBtnFn()
  typeof panguInit === 'function' && panguInit()

  if (typeof gtag === 'function') {
    gtag('config', '', {'page_path': window.location.pathname});
  }

  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()

  // Analytics
  if (false) {
    MtaH5.pgv()
  }

  // prismjs
  typeof Prism === 'object' && Prism.highlightAll()

  typeof preloader === 'object' && preloader.endLoading()
})


document.addEventListener('pjax:send', function () {
  typeof preloader === 'object' && preloader.initLoading()
  
  if (window.aplayers) {
    for (let i = 0; i < window.aplayers.length; i++) {
      if (!window.aplayers[i].options.fixed) {
        window.aplayers[i].destroy()
      }
    }
  }

  typeof typed === 'object' && typed.destroy()

  //reset readmode
  const $bodyClassList = document.body.classList
  $bodyClassList.contains('read-mode') && $bodyClassList.remove('read-mode')

})

document.addEventListener('pjax:error', (e) => {
  if (e.request.status === 404) {
    pjax.loadUrl('/404.html')
  }
})</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>